2025-07-17 13:32:26,046 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:32:26
2025-07-17 13:32:26,047 - AVRO_load_to_stg.py - INFO - 📁 Using config file: ./config/connection_details.json
2025-07-17 13:32:26,047 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: ❌ Config file not found at: ./config/connection_details.json
2025-07-17 13:38:13,295 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:38:13
2025-07-17 13:38:13,295 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:38:13,296 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: ❌ RSA key not found at: ./config/snowflake_private_key.p8
2025-07-17 13:42:53,980 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:42:53
2025-07-17 13:42:53,982 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:42:53,983 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: ❌ RSA key not found at: ./config/snowflake_private_key.p8
2025-07-17 13:48:00,962 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:48:00
2025-07-17 13:48:00,963 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:48:01,076 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 13:48:05,209 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 13:48:05,449 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 13:50:21,839 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:50:21
2025-07-17 13:50:21,840 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:50:21,896 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 13:50:24,639 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 13:50:24,888 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 13:55:51,238 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:55:51
2025-07-17 13:55:51,238 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:55:51,286 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 13:55:53,256 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 13:55:53,422 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 14:04:05,075 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:04:05
2025-07-17 14:04:05,075 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:04:05,114 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:04:07,269 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:04:07,416 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 14:12:38,831 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:12:38
2025-07-17 14:12:38,831 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:12:38,893 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:12:41,524 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:12:41,524 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:12:42,659 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143752710 closed and audit updated.
2025-07-17 14:12:42,856 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: ❌ Unsupported file type: ''. Expected 'avro'.
2025-07-17 14:15:41,745 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:15:41
2025-07-17 14:15:41,746 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:15:41,807 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:15:44,526 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:15:44,527 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:15:44,527 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:15:46,304 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:15:46,477 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:15:46,480 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:15:46,486 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:15:46,489 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:15:46,493 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:15:46,495 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:15:46,538 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:15:46,538 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:15:47,151 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143736330 closed and audit updated.
2025-07-17 14:15:47,414 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: validate_schema_matches_table() missing 1 required positional argument: 'log'
2025-07-17 14:18:46,636 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:18:46
2025-07-17 14:18:46,636 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:18:46,674 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:18:48,096 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:18:48,096 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:18:48,097 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:18:49,797 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:18:49,918 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:18:49,951 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:18:49,953 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:18:49,956 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:18:49,958 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:18:49,960 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:18:50,119 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:18:50,119 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:18:50,779 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143744530 closed and audit updated.
2025-07-17 14:18:51,033 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: 'list' object has no attribute 'log'
2025-07-17 14:29:54,228 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:29:54
2025-07-17 14:29:54,230 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:29:54,267 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:29:56,778 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:29:56,779 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:29:56,780 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:29:59,006 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:29:59,096 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:29:59,100 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:29:59,102 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:29:59,105 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:29:59,108 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:29:59,111 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:29:59,159 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:29:59,160 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:29:59,160 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:29:59,160 - AVRO_load_to_stg.py - WARNING - ⚠️ Missing expected columns: []
2025-07-17 14:29:59,160 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:30:00,765 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:30:00,870 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 14:30:00,870 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 14:30:00,871 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 14:30:00,872 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 14:30:00,873 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 14:30:01,020 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "registration_dttm"
2025-07-17 14:30:01,022 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "id"
2025-07-17 14:30:01,025 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "first_name"
2025-07-17 14:30:01,027 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "last_name"
2025-07-17 14:30:01,032 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "email"
2025-07-17 14:30:01,035 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "gender"
2025-07-17 14:30:01,037 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "ip_address"
2025-07-17 14:30:01,038 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "cc"
2025-07-17 14:30:01,040 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "country"
2025-07-17 14:30:01,042 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "birthdate"
2025-07-17 14:30:01,043 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "salary"
2025-07-17 14:30:01,046 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "title"
2025-07-17 14:30:01,536 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143756806 closed and audit updated.
2025-07-17 14:30:01,916 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1101): Cannot drop all columns
2025-07-17 14:51:27,432 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:51:27
2025-07-17 14:51:27,433 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:51:27,494 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:51:29,911 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:51:29,912 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:51:29,912 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:51:31,564 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:51:31,658 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:51:31,661 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:51:31,664 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:51:31,667 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:51:31,670 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:51:31,674 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:51:31,724 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:51:31,724 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:51:31,725 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:51:31,726 - AVRO_load_to_stg.py - WARNING - ⚠️ Missing expected columns: []
2025-07-17 14:51:31,726 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:51:33,416 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:51:33,463 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 14:51:33,464 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 14:51:33,464 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 14:51:33,465 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 14:51:33,465 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 14:51:33,466 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 14:51:33,883 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143744534 closed and audit updated.
2025-07-17 14:51:34,100 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 14:55:01,040 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:55:01
2025-07-17 14:55:01,041 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:55:01,082 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:55:03,043 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:55:03,043 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:55:03,044 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:55:04,335 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:55:04,441 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:55:04,442 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:55:04,443 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:55:04,445 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:55:04,445 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:55:04,446 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:55:04,490 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:55:04,491 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:55:04,492 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:55:04,493 - AVRO_load_to_stg.py - WARNING - ⚠️ Missing expected columns: []
2025-07-17 14:55:04,493 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:55:06,222 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:55:06,267 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 14:55:06,269 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 14:55:06,269 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 14:55:06,270 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 14:55:06,270 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 14:55:06,271 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 14:55:07,106 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760902 closed and audit updated.
2025-07-17 14:55:07,322 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:21:33,684 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:21:33
2025-07-17 15:21:33,685 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:21:33,771 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:21:36,496 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:21:36,497 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:21:36,497 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:21:38,715 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:21:38,845 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:21:38,848 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:21:38,852 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:21:38,854 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:21:38,857 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:21:38,860 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:21:38,910 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:21:38,912 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:21:38,913 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:21:38,913 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:21:38,914 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:21:38,915 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:21:38,916 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:21:38,917 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:21:38,965 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:21:38,965 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:21:38,965 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:21:38,966 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:21:40,423 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:21:40,478 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:21:40,478 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:21:40,479 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:21:40,479 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:21:40,480 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:21:40,480 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:21:41,432 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143764998 closed and audit updated.
2025-07-17 15:21:41,686 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:30:37,082 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:30:37
2025-07-17 15:30:37,082 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:30:37,118 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:30:39,114 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:30:39,115 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:30:39,116 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:30:41,102 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:30:41,294 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:30:41,298 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:30:41,301 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:30:41,304 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:30:41,308 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:30:41,310 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:30:41,407 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:30:41,410 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:30:41,413 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:30:41,416 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:30:41,419 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:30:41,421 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:30:41,424 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:30:41,426 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:30:41,476 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:30:41,476 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:30:41,477 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:30:41,477 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:30:42,656 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:30:42,707 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:30:42,708 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:30:42,708 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:30:42,709 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:30:42,710 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:30:42,711 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:30:43,458 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143769094 closed and audit updated.
2025-07-17 15:30:43,680 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:32:48,988 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:32:48
2025-07-17 15:32:48,988 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:32:49,025 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:32:51,026 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:32:51,027 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:32:51,028 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:32:52,553 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:32:52,640 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:32:52,642 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:32:52,643 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:32:52,644 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:32:52,645 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:32:52,646 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:32:52,692 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:32:52,694 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:32:52,695 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:32:52,696 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:32:52,697 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:32:52,698 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:32:52,699 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:32:52,699 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:32:52,866 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:32:52,867 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:32:52,868 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:32:52,868 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:32:53,781 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:32:53,827 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:32:53,828 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:32:53,828 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:32:53,828 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:32:53,829 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:32:53,829 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:32:54,561 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143748618 closed and audit updated.
2025-07-17 15:32:54,737 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:40:51,498 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:40:51
2025-07-17 15:40:51,498 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:40:51,542 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:40:53,728 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:40:53,729 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:40:53,730 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:40:55,138 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:40:55,326 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:40:55,330 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:40:55,333 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:40:55,337 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:40:55,342 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:40:55,346 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:40:55,346 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:40:55,644 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:40:55,645 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:40:55,646 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:40:55,646 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:40:55,649 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:40:55,651 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:40:55,654 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:40:55,656 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:40:55,657 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:40:55,659 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:40:55,660 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:40:55,713 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:40:55,713 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:40:55,714 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:40:55,714 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:40:56,969 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:40:57,020 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:40:57,021 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:40:57,021 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:40:57,021 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:40:57,022 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:40:57,022 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:40:57,022 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 15:40:57,022 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:40:57,518 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760906 closed and audit updated.
2025-07-17 15:40:57,734 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:51:07,093 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:51:07
2025-07-17 15:51:07,094 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:51:07,133 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:51:09,418 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:51:09,419 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:51:09,419 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:51:11,076 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:51:11,189 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:51:11,191 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:51:11,192 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:51:11,193 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:51:11,194 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:51:11,195 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:51:11,195 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:51:11,238 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:51:11,238 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:51:11,239 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:51:11,239 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:51:11,240 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:51:11,241 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:51:11,242 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:51:11,243 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:51:11,244 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:51:11,246 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:51:11,247 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:51:11,430 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:51:11,431 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:51:11,431 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:51:11,431 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:51:12,987 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:51:13,031 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:51:13,032 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:51:13,032 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:51:13,032 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:51:13,032 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:51:13,033 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:51:13,033 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 15:51:13,033 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:51:13,878 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143773190 closed and audit updated.
2025-07-17 15:51:14,135 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:59:15,301 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:59:15
2025-07-17 15:59:15,302 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:59:15,339 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:59:17,496 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:59:17,497 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:59:17,498 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:59:19,005 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:59:19,133 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:59:19,134 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:59:19,135 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:59:19,136 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:59:19,138 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:59:19,139 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:59:19,139 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:59:19,255 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:59:19,257 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:59:19,257 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:59:19,258 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:59:19,261 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:59:19,264 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:59:19,267 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:59:19,271 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:59:19,274 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:59:19,275 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:59:19,278 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:59:19,349 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:59:19,350 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:59:19,350 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:59:19,351 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:59:19,788 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143773194 closed and audit updated.
2025-07-17 15:59:19,967 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: 'NoneType' object has no attribute 'warning'
2025-07-17 16:03:57,761 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:03:57
2025-07-17 16:03:57,761 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:03:57,801 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:03:59,655 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:03:59,655 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:03:59,656 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:04:00,921 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:04:01,007 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:04:01,008 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:04:01,009 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:04:01,010 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:04:01,011 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:04:01,012 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:04:01,013 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,248 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:04:01,248 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:04:01,248 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,249 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:04:01,250 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:04:01,250 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:04:01,251 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:04:01,252 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:04:01,253 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:04:01,254 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:04:01,254 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:04:01,299 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,300 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,300 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:04:01,301 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:04:01,301 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:04:01,302 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:04:01,304 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:04:01,307 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:04:01,307 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:04:01,394 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,395 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:04:01,395 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:04:01,397 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:04:01,398 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:04:04,214 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760910 closed and audit updated.
2025-07-17 16:04:04,414 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: 'str' object has no attribute '_to_attributes'
2025-07-17 16:31:33,646 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:31:33
2025-07-17 16:31:33,647 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:31:33,691 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:31:36,738 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:31:36,738 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:31:36,739 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:31:38,501 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:31:38,716 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:31:38,719 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:31:38,722 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:31:38,726 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:31:38,729 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:31:38,732 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:31:38,733 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,787 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:31:38,787 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:31:38,788 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,788 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:31:38,791 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:31:38,792 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:31:38,793 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:31:38,795 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:31:38,797 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:31:38,799 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:31:38,800 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:31:38,849 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,849 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,850 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:31:38,850 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:31:38,851 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:31:38,851 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:31:38,852 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:31:38,854 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:31:38,854 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:31:38,901 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,902 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:31:38,902 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:31:38,904 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:31:38,905 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:31:40,008 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760914 closed and audit updated.
2025-07-17 16:31:40,207 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: name 'Target_table' is not defined
2025-07-17 16:36:42,198 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:36:42
2025-07-17 16:36:42,198 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:36:42,242 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:36:44,038 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:36:44,039 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:36:44,039 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:36:45,352 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:36:45,590 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:36:45,591 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:36:45,592 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:36:45,593 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:36:45,594 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:36:45,596 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:36:45,596 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,639 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:36:45,640 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:36:45,640 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,640 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:36:45,642 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:36:45,643 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:36:45,644 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:36:45,645 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:36:45,646 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:36:45,647 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:36:45,648 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:36:45,796 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,798 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,798 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:36:45,799 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:36:45,799 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:36:45,800 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:36:45,803 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:36:45,805 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:36:45,805 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:36:45,860 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,860 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:36:45,861 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:36:45,863 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:36:45,865 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:36:49,730 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: 01bdc248-0306-0009-000c-7ee3000a228a
2025-07-17 16:36:50,619 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143777286 closed and audit updated.
2025-07-17 16:36:50,832 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: can only concatenate str (not "NoneType") to str
2025-07-17 16:49:08,885 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:49:08
2025-07-17 16:49:08,886 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:49:08,933 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:49:11,558 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:49:11,559 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:49:11,559 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:49:12,842 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:49:13,039 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:49:13,042 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:49:13,045 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:49:13,048 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:49:13,050 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:49:13,053 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:49:13,053 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,116 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:49:13,117 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:49:13,118 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,118 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:49:13,120 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:49:13,122 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:49:13,123 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:49:13,125 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:49:13,126 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:49:13,127 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:49:13,128 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:49:13,174 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,174 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,174 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:49:13,175 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:49:13,175 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:49:13,175 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:49:13,176 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:49:13,177 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:49:13,177 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:49:13,232 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,233 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:49:13,234 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:49:13,236 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:49:13,237 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:49:16,591 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 16:49:16,592 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 16:49:17,370 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143744538 closed and audit updated.
2025-07-17 16:49:17,595 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: can only concatenate str (not "NoneType") to str
2025-07-17 16:58:04,374 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:58:04
2025-07-17 16:58:04,374 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:58:04,412 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:58:06,449 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:58:06,450 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:58:06,450 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:58:07,618 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:58:07,831 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:58:07,834 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:58:07,837 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:58:07,842 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:58:07,846 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:58:07,849 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:58:07,850 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:07,907 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:58:07,909 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:58:07,909 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:07,910 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:58:07,913 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:58:07,916 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:58:07,918 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:58:07,921 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:58:07,923 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:58:07,925 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:58:07,928 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:58:08,093 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:08,094 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:08,094 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:58:08,095 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:58:08,096 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:58:08,097 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:58:08,099 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:58:08,102 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:58:08,103 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:58:08,154 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:08,156 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:58:08,156 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:58:08,159 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:58:08,162 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:58:10,843 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 16:58:10,843 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 16:58:11,794 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760918 closed and audit updated.
2025-07-17 16:58:12,010 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: name 'log' is not defined
2025-07-17 17:04:22,929 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:04:22
2025-07-17 17:04:22,929 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:04:22,970 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:04:25,241 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:04:25,242 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:04:25,242 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:04:26,670 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:04:26,758 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:04:26,759 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:04:26,761 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:04:26,763 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:04:26,765 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:04:26,767 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:04:26,770 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:04:26,770 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:26,946 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:04:26,947 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:04:26,947 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:26,948 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:04:26,951 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:04:26,954 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:04:26,958 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:04:26,961 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:04:26,964 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:04:26,966 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:04:26,969 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:04:27,024 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:27,025 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:27,025 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:04:27,026 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:04:27,027 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:04:27,028 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:04:27,030 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:04:27,033 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:04:27,033 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:04:27,194 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:27,195 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:04:27,196 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:04:27,198 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:04:27,200 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:04:31,672 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:04:31,673 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:04:32,333 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143748622 closed and audit updated.
2025-07-17 17:04:32,542 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: name 'log' is not defined
2025-07-17 17:07:18,044 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:07:18
2025-07-17 17:07:18,045 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:07:18,106 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:07:21,199 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:07:21,214 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:07:21,214 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:07:22,795 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:07:23,066 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:07:23,067 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:07:23,068 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:07:23,069 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:07:23,070 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:07:23,071 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:07:23,073 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:07:23,073 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,116 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:07:23,116 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:07:23,116 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,117 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:07:23,118 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:07:23,119 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:07:23,121 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:07:23,122 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:07:23,123 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:07:23,125 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:07:23,126 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:07:23,183 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,183 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,183 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:07:23,184 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:07:23,184 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:07:23,184 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:07:23,185 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:07:23,186 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:07:23,186 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:07:23,239 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,239 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:07:23,240 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:07:23,241 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:07:23,242 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:07:30,323 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:07:30,323 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:07:30,798 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143773198 closed and audit updated.
2025-07-17 17:07:31,077 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: collect_rejects() missing 1 required positional argument: 'log'
2025-07-17 17:11:14,989 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:11:14
2025-07-17 17:11:14,989 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:11:15,038 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:11:16,978 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:11:16,979 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:11:16,980 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:11:18,492 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:11:18,594 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:11:18,595 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:11:18,599 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:11:18,601 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:11:18,602 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:11:18,604 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:11:18,605 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:11:18,606 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,648 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:11:18,649 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:11:18,649 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,649 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:11:18,650 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:11:18,651 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:11:18,653 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:11:18,654 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:11:18,655 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:11:18,659 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:11:18,661 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:11:18,718 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,718 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,719 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:11:18,719 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:11:18,719 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:11:18,720 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:11:18,721 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:11:18,722 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:11:18,722 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:11:18,790 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,791 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:11:18,791 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:11:18,792 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:11:18,792 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:11:22,154 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:11:22,155 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:11:22,206 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:11:22,642 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143736334 closed and audit updated.
2025-07-17 17:11:22,855 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: Cannot infer schema from empty data
2025-07-17 17:20:01,131 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:20:01
2025-07-17 17:20:01,133 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:20:01,205 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:20:03,464 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:20:03,465 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:20:03,466 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:20:04,776 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:20:04,882 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:20:04,883 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:20:04,886 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:20:04,890 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:20:04,893 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:20:04,896 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:20:04,899 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:20:04,900 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:04,947 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:20:04,947 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:20:04,948 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:04,948 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:20:04,949 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:20:04,950 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:20:04,951 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:20:04,952 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:20:04,953 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:20:04,953 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:20:04,954 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:20:04,999 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:05,000 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:05,000 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:20:05,001 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:20:05,001 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:20:05,002 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:20:05,003 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:20:05,004 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:20:05,005 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:20:05,052 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:05,053 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:20:05,053 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:20:05,054 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:20:05,055 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:20:09,279 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:20:09,279 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:20:09,333 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:20:09,852 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143748626 closed and audit updated.
2025-07-17 17:20:10,095 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: The provided schema or inferred schema cannot be None or empty
2025-07-17 17:24:25,256 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:24:25
2025-07-17 17:24:25,256 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:24:25,294 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:24:27,185 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:24:27,186 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:24:27,186 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:24:28,515 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:24:28,761 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:24:28,761 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:24:28,763 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:24:28,764 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:24:28,764 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:24:28,765 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:24:28,766 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:24:28,766 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,812 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:24:28,816 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:24:28,819 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,819 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:24:28,821 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:24:28,822 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:24:28,824 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:24:28,863 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:24:28,865 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:24:28,865 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:24:28,866 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:24:28,929 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,929 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,929 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:24:28,929 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:24:28,930 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:24:28,930 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:24:28,930 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:24:28,931 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:24:28,931 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:24:28,982 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,983 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:24:28,983 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:24:28,984 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:24:28,985 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:24:32,642 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:24:32,643 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:24:32,689 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:24:33,174 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143744542 closed and audit updated.
2025-07-17 17:24:33,398 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: name 'StructField' is not defined
2025-07-17 17:25:49,860 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:25:49
2025-07-17 17:25:49,861 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:25:49,960 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:25:52,329 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:25:52,329 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:25:52,329 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:25:53,784 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:25:53,934 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:25:53,935 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:25:53,938 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:25:53,942 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:25:53,945 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:25:53,948 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:25:53,950 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:25:53,951 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:53,996 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:25:53,996 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:25:53,997 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:53,997 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:25:53,998 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:25:53,999 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:25:53,999 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:25:54,000 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:25:54,001 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:25:54,002 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:25:54,003 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:25:54,048 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:54,049 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:54,049 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:25:54,050 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:25:54,050 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:25:54,050 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:25:54,051 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:25:54,052 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:25:54,053 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:25:54,096 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:54,097 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:25:54,097 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:25:54,099 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:25:54,100 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:25:57,376 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:25:57,377 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:25:57,431 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:25:57,483 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 7.62 seconds
2025-07-17 17:25:57,704 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:25:57,704 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:25:57,704 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:25:57,705 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:25:58,634 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143777290 closed and audit updated.
2025-07-17 17:25:58,842 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:29:16,964 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:29:16
2025-07-17 17:29:16,964 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:29:17,002 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:29:18,633 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:29:18,634 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:29:18,635 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:29:19,765 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:29:19,859 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:29:19,859 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:29:19,861 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:29:19,863 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:29:19,865 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:29:19,867 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:29:19,869 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:29:19,870 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:19,924 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:29:19,925 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:29:19,926 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:19,926 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:29:19,927 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:29:19,929 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:29:19,930 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:29:19,931 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:29:19,933 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:29:19,934 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:29:19,935 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:29:19,977 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:19,977 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:19,977 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:29:19,978 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:29:19,978 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:29:19,978 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:29:19,979 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:29:19,980 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:29:19,980 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:29:20,023 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:20,025 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:29:20,026 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:29:20,027 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:29:20,028 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:29:23,553 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:29:23,554 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:29:23,612 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:29:23,651 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 6.69 seconds
2025-07-17 17:29:23,852 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:29:23,853 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:29:23,853 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:29:23,854 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:29:24,594 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760922 closed and audit updated.
2025-07-17 17:29:24,782 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:31:57,894 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:31:57
2025-07-17 17:31:57,894 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:31:57,931 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:31:59,556 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:31:59,556 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:31:59,557 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:32:00,912 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:32:01,017 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:32:01,018 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:32:01,019 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:32:01,020 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:32:01,021 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:32:01,022 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:32:01,023 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:32:01,024 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,077 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:32:01,077 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:32:01,078 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,078 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:32:01,081 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:32:01,082 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:32:01,084 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:32:01,087 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:32:01,088 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:32:01,090 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:32:01,092 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:32:01,151 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,152 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,152 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:32:01,153 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:32:01,153 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:32:01,153 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:32:01,154 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:32:01,155 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:32:01,155 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:32:01,204 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,204 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:32:01,205 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:32:01,207 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:32:01,209 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:32:05,224 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:32:05,225 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:32:05,271 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:32:05,316 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 7.42 seconds
2025-07-17 17:32:05,989 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:32:05,989 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:32:05,990 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:32:05,991 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:32:06,860 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143777294 closed and audit updated.
2025-07-17 17:32:07,058 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:51:01,360 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:51:01
2025-07-17 17:51:01,361 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:51:01,413 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:51:03,983 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:51:03,984 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:51:03,985 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:05,784 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:51:05,887 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:05,888 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:05,890 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:51:05,891 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:51:05,893 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:05,894 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:05,895 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:51:05,895 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,106 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:06,106 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:06,106 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,106 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:51:06,107 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:51:06,108 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:51:06,109 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:51:06,110 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:51:06,111 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:51:06,111 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:51:06,112 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:51:06,155 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,156 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,156 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:06,156 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:06,157 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:51:06,157 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:51:06,158 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:06,159 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:06,159 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:51:06,207 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,207 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:51:06,207 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:51:06,208 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:51:06,209 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:51:09,870 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:51:09,870 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:51:09,912 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:51:09,955 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 8.59 seconds
2025-07-17 17:51:10,166 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:10,167 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:10,167 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:51:10,167 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:51:10,633 - AVRO_load_to_stg.py - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:51:10,679 - AVRO_load_to_stg.py - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-17 17:51:11,348 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143752714 closed and audit updated.
2025-07-17 17:51:13,529 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:51:13
2025-07-17 17:51:13,529 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:51:13,566 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:51:14,950 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:51:14,951 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:51:14,951 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:16,184 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:51:16,279 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:16,280 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:16,283 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:51:16,285 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:51:16,288 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:16,291 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:16,294 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:51:16,294 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,342 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:16,342 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:16,342 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,342 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:51:16,345 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:51:16,346 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:51:16,348 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:51:16,349 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:51:16,352 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:51:16,353 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:51:16,354 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:51:16,397 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,398 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,398 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:16,399 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:16,400 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:51:16,400 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:51:16,402 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:16,403 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:16,404 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:51:16,448 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,448 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:51:16,449 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:51:16,450 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:51:16,450 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:51:19,406 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:51:19,406 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:51:19,452 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:51:19,493 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 5.96 seconds
2025-07-17 17:51:19,694 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:19,694 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:19,695 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:51:19,696 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:51:20,127 - AVRO_load_to_stg.py - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:51:20,175 - AVRO_load_to_stg.py - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-17 17:51:20,574 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143752718 closed and audit updated.
2025-07-17 17:51:22,618 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:51:22
2025-07-17 17:51:22,619 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:51:22,659 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:51:23,840 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:51:23,841 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:51:23,841 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:25,195 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:51:25,319 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:25,319 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:25,320 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:51:25,321 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:51:25,323 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:25,325 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:25,327 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:51:25,327 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,374 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:25,375 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:25,375 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,376 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:51:25,378 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:51:25,379 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:51:25,380 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:51:25,381 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:51:25,382 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:51:25,383 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:51:25,384 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:51:25,429 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,429 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,430 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:25,430 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:25,430 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:51:25,430 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:51:25,432 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:25,433 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:25,433 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:51:25,475 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,476 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:51:25,476 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:51:25,477 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:51:25,478 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:51:29,343 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:51:29,344 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:51:29,392 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:51:29,438 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 6.82 seconds
2025-07-17 17:51:29,672 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:29,673 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:29,674 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:51:29,674 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:51:30,231 - AVRO_load_to_stg.py - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:51:30,283 - AVRO_load_to_stg.py - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-17 17:51:30,719 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143769098 closed and audit updated.
2025-07-18 08:21:08,996 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-18 08:21:08
2025-07-18 08:21:08,998 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-18 08:21:09,053 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-18 08:21:12,732 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-18 08:21:12,771 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-18 08:21:12,772 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 08:21:14,976 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 08:21:15,077 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 08:21:15,078 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 08:21:15,081 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 08:21:15,089 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 08:21:15,092 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 08:21:15,095 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 08:21:15,098 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 08:21:15,099 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,171 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 08:21:15,171 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 08:21:15,172 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,173 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 08:21:15,176 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 08:21:15,179 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 08:21:15,181 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 08:21:15,184 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 08:21:15,186 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 08:21:15,188 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 08:21:15,190 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 08:21:15,250 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,251 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,251 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-18 08:21:15,252 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-18 08:21:15,252 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 08:21:15,253 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 08:21:15,254 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 08:21:15,256 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 08:21:15,256 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 08:21:15,522 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,522 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 08:21:15,522 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 08:21:15,523 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 08:21:15,524 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 08:21:20,048 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 08:21:20,048 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-18 08:21:20,100 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 08:21:20,158 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 11.16 seconds
2025-07-18 08:21:20,321 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 08:21:20,322 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 08:21:20,323 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 08:21:20,324 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 08:21:20,827 - AVRO_load_to_stg.py - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-18 08:21:20,877 - AVRO_load_to_stg.py - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 08:21:21,843 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143748630 closed and audit updated.
2025-07-18 11:54:43,042 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 11:54:43,042 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 11:54:43,043 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 11:54:43
2025-07-18 11:54:43,043 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 11:54:43,099 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 11:54:46,792 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 11:54:46,793 - AVRO_setup_logger - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-18 11:54:46,794 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 11:54:46,795 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 11:54:48,598 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 11:54:48,833 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,834 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,837 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 11:54:48,840 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 11:54:48,842 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 11:54:48,844 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 11:54:48,846 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 11:54:48,897 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,898 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,899 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,899 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 11:54:48,899 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 11:54:48,900 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 11:54:48,902 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 11:54:48,903 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 11:54:48,904 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 11:54:48,905 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 11:54:48,906 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 11:54:48,907 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 11:54:48,953 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 11:54:48,954 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 11:54:48,954 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 11:54:48,954 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 11:54:48,954 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 11:54:48,954 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 11:54:48,955 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 11:54:48,956 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 11:54:48,956 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 11:54:49,008 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 11:54:49,009 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 11:54:49,009 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 11:54:49,010 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 11:54:49,011 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 11:54:52,921 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 11:54:52,922 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 11:54:52,971 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 11:54:53,039 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 10.0 seconds
2025-07-18 11:54:53,273 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 11:54:53,274 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 11:54:53,275 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 11:54:53,276 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 11:54:53,741 - AVRO_setup_logger - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-18 11:54:53,789 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 11:54:54,235 - AVRO_setup_logger - INFO - 🛑 Session 3517213143781382 closed and audit updated.
2025-07-18 12:27:47,603 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 12:27:47,604 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 12:27:47,604 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 12:27:47
2025-07-18 12:27:47,604 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 12:27:47,651 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 12:27:50,809 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 12:27:50,892 - AVRO_setup_logger - WARNING - ⚠️ Could not convert session details to pandas DataFrame so session audit was skipped: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-18 12:27:50,893 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:27:50,894 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 12:27:52,474 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 12:27:52,585 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,586 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,589 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 12:27:52,594 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 12:27:52,597 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:27:52,600 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:27:52,604 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 12:27:52,655 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,657 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,657 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,657 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:27:52,658 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 12:27:52,659 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 12:27:52,661 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 12:27:52,663 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 12:27:52,664 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 12:27:52,665 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 12:27:52,667 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 12:27:52,668 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 12:27:52,802 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:27:52,802 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:27:52,802 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:27:52,802 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:27:52,802 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 12:27:52,803 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 12:27:52,803 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:27:52,804 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:27:52,804 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 12:27:52,852 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:27:52,853 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:27:52,854 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 12:27:52,857 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 12:27:52,859 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 12:27:56,217 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 12:27:56,217 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 12:27:56,263 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 12:27:56,309 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 8.7 seconds
2025-07-18 12:27:56,476 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:27:56,476 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:27:56,476 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 12:27:56,477 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 12:27:56,973 - AVRO_setup_logger - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-18 12:27:57,014 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 12:27:58,216 - AVRO_setup_logger - INFO - 🛑 Session 3517213143785478 closed and audit updated.
2025-07-18 12:29:45,370 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 12:29:45,371 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 12:29:45,371 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 12:29:45
2025-07-18 12:29:45,371 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 12:29:45,417 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 12:29:48,001 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 12:29:48,143 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143789574  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 12:29:48.216000-07:00 2999-01-01
2025-07-18 12:29:48,143 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:29:48,143 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 12:29:49,690 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 12:29:49,794 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,795 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,796 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 12:29:49,797 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 12:29:49,798 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:29:49,799 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:29:49,800 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 12:29:49,842 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,843 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,843 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,843 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:29:49,844 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 12:29:49,845 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 12:29:49,846 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 12:29:49,847 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 12:29:49,848 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 12:29:49,849 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 12:29:49,850 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 12:29:49,852 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 12:29:49,893 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:29:49,894 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:29:49,894 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:29:49,894 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:29:49,895 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 12:29:49,895 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 12:29:49,896 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:29:49,897 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:29:49,897 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 12:29:49,946 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:29:49,946 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:29:49,947 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 12:29:49,948 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 12:29:49,950 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 12:29:54,444 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 12:29:54,445 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 12:29:54,492 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 12:29:54,528 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.16 seconds
2025-07-18 12:29:54,671 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:29:54,672 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:29:54,672 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 12:29:54,672 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 12:29:55,106 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 12:29:56,053 - AVRO_setup_logger - INFO - 🛑 Session 3517213143789574 closed and audit updated.
2025-07-18 12:42:37,956 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 12:42:37,956 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-18 12:42:37,956 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 12:42:37,957 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 12:42:37
2025-07-18 12:42:37,957 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 12:42:37,996 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 12:42:40,670 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 12:42:41,034 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143789578  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 12:42:41.165000-07:00 2999-01-01
2025-07-18 12:42:41,034 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:42:41,034 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 12:42:42,613 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 12:42:42,896 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,896 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,898 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 12:42:42,901 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 12:42:42,904 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:42:42,907 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:42:42,909 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 12:42:42,965 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,966 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,966 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,966 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:42:42,967 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 12:42:42,967 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 12:42:42,969 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 12:42:42,970 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 12:42:42,971 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 12:42:42,971 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 12:42:42,973 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 12:42:42,973 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 12:42:43,019 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:42:43,019 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:42:43,019 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:42:43,020 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:42:43,020 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 12:42:43,020 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 12:42:43,021 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:42:43,022 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:42:43,022 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 12:42:43,067 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:42:43,069 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:42:43,070 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 12:42:43,072 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 12:42:43,073 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 12:42:46,977 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 12:42:46,977 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 12:42:47,036 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 12:42:47,077 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.12 seconds
2025-07-18 12:42:47,288 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:42:47,289 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:42:47,289 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 12:42:47,289 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 12:42:47,818 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 12:42:48,398 - AVRO_setup_logger - INFO - 🛑 Session 3517213143789578 closed and audit updated.
2025-07-18 14:46:36,756 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 14:46:36,757 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-18 14:46:36,758 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 14:46:36,758 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 14:46:36
2025-07-18 14:46:36,759 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 14:46:36,814 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 14:46:40,233 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 14:46:40,378 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143793670  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 14:46:40.489000-07:00 2999-01-01
2025-07-18 14:46:40,378 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 14:46:40,379 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 14:46:42,379 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 14:46:42,540 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,540 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,543 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 14:46:42,556 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 14:46:42,557 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 14:46:42,559 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 14:46:42,560 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 14:46:42,609 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,609 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,610 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,610 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 14:46:42,610 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 14:46:42,611 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 14:46:42,612 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 14:46:42,612 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 14:46:42,613 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 14:46:42,613 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 14:46:42,614 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 14:46:42,614 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 14:46:42,665 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 14:46:42,666 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 14:46:42,666 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 14:46:42,666 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 14:46:42,667 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 14:46:42,667 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 14:46:42,668 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 14:46:42,669 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 14:46:42,669 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 14:46:42,854 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 14:46:42,855 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 14:46:42,855 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 14:46:42,856 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 14:46:42,857 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 14:46:46,608 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 14:46:46,608 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 14:46:46,663 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 14:46:46,716 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.96 seconds
2025-07-18 14:46:46,877 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 14:46:46,878 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 14:46:46,878 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 14:46:46,879 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 14:46:47,310 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 14:46:47,912 - AVRO_setup_logger - INFO - 🛑 Session 3517213143793670 closed and audit updated.
2025-07-18 16:59:53,690 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 16:59:53,691 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-18 16:59:53,691 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 16:59:53,692 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 16:59:53
2025-07-18 16:59:53,692 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 16:59:53,744 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 16:59:56,763 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 16:59:57,045 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143785498  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 16:59:57.063000-07:00 2999-01-01
2025-07-18 16:59:57,045 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 16:59:57,046 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 16:59:58,747 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 16:59:58,841 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 16:59:58,841 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 16:59:58,845 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 16:59:58,847 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 16:59:58,851 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 16:59:58,854 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 16:59:58,857 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 16:59:59,097 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 16:59:59,099 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 16:59:59,099 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 16:59:59,100 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 16:59:59,100 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 16:59:59,104 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 16:59:59,106 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 16:59:59,109 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 16:59:59,110 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 16:59:59,112 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 16:59:59,114 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 16:59:59,115 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 16:59:59,161 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 16:59:59,162 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 16:59:59,162 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 16:59:59,163 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 16:59:59,163 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 16:59:59,164 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 16:59:59,166 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 16:59:59,167 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 16:59:59,168 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 16:59:59,218 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 16:59:59,218 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 16:59:59,219 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 16:59:59,222 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 16:59:59,223 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 17:00:03,620 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 17:00:03,620 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 17:00:03,730 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 17:00:03,790 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 10.1 seconds
2025-07-18 17:00:04,141 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:00:04,142 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:00:04,143 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 17:00:04,143 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 17:00:04,306 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 17:00:04,770 - AVRO_setup_logger - INFO - 🛑 Session 3517213143785498 closed and audit updated.
2025-07-18 17:12:10,159 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 17:12:10,159 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-18 17:12:10,159 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 17:12:10,160 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 17:12:10
2025-07-18 17:12:10,160 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 17:12:10,209 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 17:12:12,927 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 17:12:13,069 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143781394  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 17:12:13.231000-07:00 2999-01-01
2025-07-18 17:12:13,070 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 17:12:13,070 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 17:12:14,929 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 17:12:15,185 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:12:15,185 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:12:15,186 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 17:12:15,187 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 17:12:15,188 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 17:12:15,189 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 17:12:15,190 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 17:12:15,254 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:12:15,254 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:12:15,255 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:12:15,255 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:12:15,255 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 17:12:15,256 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 17:12:15,257 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 17:12:15,258 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 17:12:15,259 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 17:12:15,260 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 17:12:15,260 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 17:12:15,261 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 17:12:15,306 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:12:15,306 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:12:15,306 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 17:12:15,306 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 17:12:15,307 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 17:12:15,307 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 17:12:15,308 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 17:12:15,308 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 17:12:15,309 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 17:12:15,400 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:12:15,400 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 17:12:15,400 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 17:12:15,401 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 17:12:15,402 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 17:12:16,915 - AVRO_setup_logger - INFO - 📤 Writing 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-18 17:12:20,161 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 17:12:20,162 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 17:12:20,225 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 17:12:20,270 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 10.11 seconds
2025-07-18 17:12:20,515 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:12:20,515 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:12:20,515 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 17:12:20,516 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 17:12:20,642 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 17:12:21,317 - AVRO_setup_logger - INFO - 🛑 Session 3517213143781394 closed and audit updated.
2025-07-18 17:18:55,546 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 17:18:55,547 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-18 17:18:55,547 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 17:18:55,547 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 17:18:55
2025-07-18 17:18:55,547 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 17:18:55,583 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 17:18:58,952 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 17:18:59,030 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143797774  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 17:18:59.255000-07:00 2999-01-01
2025-07-18 17:18:59,030 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 17:18:59,030 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 17:19:00,596 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 17:19:00,738 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:19:00,739 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:19:00,740 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 17:19:00,741 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 17:19:00,743 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 17:19:00,745 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 17:19:00,746 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 17:19:00,801 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:19:00,802 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:19:00,803 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:19:00,803 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:19:00,804 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 17:19:00,807 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 17:19:00,810 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 17:19:00,813 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 17:19:00,815 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 17:19:00,818 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 17:19:00,821 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 17:19:00,822 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 17:19:00,891 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:19:00,891 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:19:00,892 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 17:19:00,893 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 17:19:00,893 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 17:19:00,894 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 17:19:00,896 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 17:19:00,898 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 17:19:00,899 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 17:19:01,008 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:19:01,009 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 17:19:01,010 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 17:19:01,012 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 17:19:01,014 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 17:19:02,343 - AVRO_setup_logger - INFO - 📤 Writing 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-18 17:19:04,815 - AVRO_setup_logger - INFO - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-18 17:19:06,134 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 17:19:06,135 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 17:19:06,189 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 17:19:06,236 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 10.69 seconds
2025-07-18 17:19:06,427 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:19:06,428 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:19:06,429 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 17:19:06,430 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 17:19:06,551 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 17:19:07,191 - AVRO_setup_logger - INFO - 🛑 Session 3517213143797774 closed and audit updated.
2025-07-18 17:34:20,736 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 17:34:20,737 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-18 17:34:20,738 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 17:34:20,738 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 17:34:20
2025-07-18 17:34:20,738 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 17:34:20,791 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 17:34:23,269 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 17:34:23,489 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143814150  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 17:34:23.576000-07:00 2999-01-01
2025-07-18 17:34:23,490 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 17:34:23,491 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 17:34:25,185 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 17:34:25,343 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:34:25,345 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:34:25,347 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 17:34:25,352 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 17:34:25,355 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 17:34:25,359 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 17:34:25,362 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 17:34:25,445 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:34:25,446 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:34:25,447 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:34:25,448 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:34:25,448 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 17:34:25,451 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 17:34:25,454 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 17:34:25,457 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 17:34:25,459 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 17:34:25,462 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 17:34:25,464 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 17:34:25,466 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 17:34:25,512 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:34:25,514 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:34:25,514 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 17:34:25,515 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 17:34:25,516 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 17:34:25,516 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 17:34:25,518 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 17:34:25,521 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 17:34:25,521 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 17:34:25,594 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:34:25,595 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 17:34:25,596 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 17:34:25,597 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 17:34:25,599 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 17:34:26,909 - AVRO_setup_logger - DEBUG - 📤 Writing 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-18 17:34:29,411 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-18 17:34:30,936 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 17:34:30,937 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 17:34:30,988 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 17:34:31,037 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 10.3 seconds
2025-07-18 17:34:31,205 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:34:31,205 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:34:31,205 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 17:34:31,205 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 17:34:31,315 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 17:34:31,933 - AVRO_setup_logger - INFO - 🛑 Session 3517213143814150 closed and audit updated.
2025-07-18 17:40:13,309 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 17:40:13,310 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-18 17:40:13,310 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 17:40:13,310 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 17:40:13
2025-07-18 17:40:13,311 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 17:40:13,349 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 17:40:14,878 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 17:40:15,037 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143822342  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 17:40:15.189000-07:00 2999-01-01
2025-07-18 17:40:15,038 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 17:40:15,039 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 17:40:16,714 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 17:40:16,824 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:40:16,825 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:40:16,826 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 17:40:16,827 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 17:40:16,829 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 17:40:16,831 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 17:40:16,831 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 17:40:16,882 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:40:16,883 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:40:16,883 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 17:40:16,884 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:40:16,884 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 17:40:16,885 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 17:40:16,887 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 17:40:16,888 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 17:40:16,890 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 17:40:16,891 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 17:40:16,892 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 17:40:16,892 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 17:40:16,948 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:40:16,948 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:40:16,948 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 17:40:16,948 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 17:40:16,948 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 17:40:16,949 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 17:40:16,949 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 17:40:16,950 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 17:40:16,950 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 17:40:17,007 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 17:40:17,007 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 17:40:17,007 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 17:40:17,008 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 17:40:17,009 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 17:40:18,538 - AVRO_setup_logger - DEBUG - 📤 Writing 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-18 17:40:20,887 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-18 17:40:21,932 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 17:40:21,933 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 17:40:21,991 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 17:40:22,041 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 8.73 seconds
2025-07-18 17:40:22,241 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:40:22,242 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 17:40:22,242 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 17:40:22,243 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 17:40:22,417 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 17:40:23,362 - AVRO_setup_logger - INFO - 🛑 Session 3517213143822342 closed and audit updated.
2025-07-21 08:22:05,149 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 08:22:05,150 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 08:22:05,150 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 08:22:05,150 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 08:22:05
2025-07-21 08:22:05,150 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 08:22:05,207 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 08:22:07,186 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 08:22:07,308 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143826454  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 08:22:07.477000-07:00 2999-01-01
2025-07-21 08:22:07,308 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 08:22:07,308 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 08:22:08,780 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 08:22:08,927 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 08:22:08,927 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 08:22:08,929 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 08:22:08,930 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 08:22:08,932 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 08:22:08,933 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 08:22:08,935 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 08:22:09,023 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 08:22:09,023 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 08:22:09,023 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 08:22:09,023 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 08:22:09,023 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-21 08:22:09,027 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 08:22:09,027 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-21 08:22:09,027 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 08:22:09,027 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 08:22:09,027 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-21 08:22:09,027 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-21 08:22:09,027 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 08:22:09,093 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 08:22:09,107 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 08:22:09,107 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 08:22:09,107 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 08:22:09,108 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-21 08:22:09,108 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-21 08:22:09,109 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 08:22:09,111 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 08:22:09,111 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-21 08:22:09,189 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 08:22:09,189 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 08:22:09,189 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-21 08:22:09,190 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-21 08:22:09,191 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-21 08:22:10,169 - AVRO_setup_logger - DEBUG - 📤 Writing 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-21 08:22:12,267 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-21 08:22:13,288 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 08:22:13,289 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 08:22:13,337 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 08:22:13,428 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 8.28 seconds
2025-07-21 08:22:13,605 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 08:22:13,605 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 08:22:13,605 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 08:22:13,605 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 08:22:13,798 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 08:22:14,311 - AVRO_setup_logger - INFO - 🛑 Session 3517213143826454 closed and audit updated.
2025-07-21 09:22:16,086 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 09:22:16,087 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 09:22:16,087 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 09:22:16,087 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 09:22:16
2025-07-21 09:22:16,087 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 09:22:16,140 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 09:22:18,330 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 09:22:18,505 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143834650  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 09:22:18.644000-07:00 2999-01-01
2025-07-21 09:22:18,505 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 09:22:18,505 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 09:22:20,343 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 09:22:20,480 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 09:22:21,166 - AVRO_setup_logger - INFO - 🛑 Session 3517213143834650 closed and audit updated.
2025-07-21 09:22:21,418 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: 'list' object has no attribute 'show'
2025-07-21 11:23:55,075 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 11:23:55,075 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 11:23:55,075 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 11:23:55,075 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 11:23:55
2025-07-21 11:23:55,075 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 11:23:55,133 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 11:23:59,445 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 11:23:59,680 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143863302  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 11:23:59.790000-07:00 2999-01-01
2025-07-21 11:23:59,681 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 11:23:59,681 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 11:24:01,698 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 11:24:01,902 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 11:24:03,335 - AVRO_setup_logger - INFO - 🛑 Session 3517213143863302 closed and audit updated.
2025-07-21 11:24:03,589 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: 'list' object has no attribute 'show'
2025-07-21 11:31:39,920 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 11:31:39,921 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 11:31:39,921 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 11:31:39,922 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 11:31:39
2025-07-21 11:31:39,922 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 11:31:39,971 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 11:31:42,197 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 11:31:42,475 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143838746  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 11:31:42.545000-07:00 2999-01-01
2025-07-21 11:31:42,475 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 11:31:42,475 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 11:31:44,959 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 11:31:45,062 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 11:31:45,065 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 11:31:45,069 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 11:31:45,073 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 11:31:45,078 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 11:31:45,083 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 11:31:45,087 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 11:31:45,165 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 11:31:45,166 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 11:31:45,167 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 11:31:45,167 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 11:31:45,168 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-21 11:31:45,173 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 11:31:45,178 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-21 11:31:45,183 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 11:31:45,186 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 11:31:45,189 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-21 11:31:45,192 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-21 11:31:45,194 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 11:31:45,266 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 11:31:45,266 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 11:31:45,266 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 11:31:45,267 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 11:31:45,267 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-21 11:31:45,267 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-21 11:31:45,269 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 11:31:45,270 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 11:31:45,270 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-21 11:31:45,419 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 11:31:45,419 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 11:31:45,421 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-21 11:31:45,421 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-21 11:31:45,425 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-21 11:31:47,109 - AVRO_setup_logger - DEBUG - 📤 Writing 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-21 11:31:49,567 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-21 11:31:50,437 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 11:31:50,438 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 11:31:50,528 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 11:31:50,590 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 10.67 seconds
2025-07-21 11:31:50,908 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 11:31:50,909 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 11:31:50,909 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 11:31:50,909 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 11:31:51,105 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 11:31:51,650 - AVRO_setup_logger - INFO - 🛑 Session 3517213143838746 closed and audit updated.
2025-07-21 12:30:31,659 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 12:30:31,659 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 12:30:31,659 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 12:30:31,659 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 12:30:31
2025-07-21 12:30:31,659 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 12:30:31,721 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 12:30:34,908 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 12:30:35,269 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143867398  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 12:30:35.271000-07:00 2999-01-01
2025-07-21 12:30:35,269 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 12:30:35,269 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 12:30:36,888 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 12:30:37,310 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:30:37,311 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:30:37,315 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 12:30:37,319 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 12:30:37,323 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 12:30:37,326 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 12:30:37,329 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 12:30:37,410 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:30:37,411 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:30:37,411 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:30:37,411 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:30:37,412 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:30:37,412 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 12:30:37,414 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 12:30:37,415 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 12:30:37,417 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 12:30:37,420 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 12:30:37,421 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 12:30:37,424 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 12:30:37,426 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 12:30:37,605 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:30:37,605 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:30:37,605 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 12:30:37,772 - AVRO_setup_logger - DEBUG - 📤 Writing DataFrame to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:30:39,313 - AVRO_setup_logger - DEBUG - 📤 Writing 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-21 12:30:42,375 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-21 12:30:43,922 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 12:30:43,922 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 12:30:44,022 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 12:30:44,056 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 12.4 seconds
2025-07-21 12:30:44,333 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 12:30:44,335 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 12:30:44,336 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 12:30:44,336 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 12:30:44,537 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 12:30:44,993 - AVRO_setup_logger - INFO - 🛑 Session 3517213143867398 closed and audit updated.
2025-07-21 12:55:00,911 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 12:55:00,912 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 12:55:00,912 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 12:55:00,912 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 12:55:00
2025-07-21 12:55:00,913 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 12:55:00,963 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 12:55:04,463 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 12:55:04,705 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143846954  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 12:55:04.838000-07:00 2999-01-01
2025-07-21 12:55:04,705 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 12:55:04,705 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 12:55:06,248 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 12:55:06,609 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:55:06,610 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:55:06,613 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 12:55:06,617 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 12:55:06,620 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 12:55:06,625 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 12:55:06,631 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 12:55:06,711 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:55:06,711 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:55:06,712 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:55:06,712 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 12:55:06,712 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:55:06,713 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 12:55:06,715 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 12:55:06,719 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 12:55:06,722 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 12:55:06,725 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 12:55:06,728 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 12:55:06,730 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 12:55:06,731 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 12:55:06,917 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:55:06,918 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:55:06,918 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 12:55:08,862 - AVRO_setup_logger - DEBUG - 📤 Writing 1000 rows from df to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/  with columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 12:55:10,498 - AVRO_setup_logger - DEBUG - ✅ Rows unloaded to temp stage: 1000, Bytes in: 68257, Bytes out: 22642
2025-07-21 12:55:11,827 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-21 12:55:13,000 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 12:55:13,001 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 12:55:13,420 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 12:55:13,506 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 12.59 seconds
2025-07-21 12:55:13,690 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 12:55:13,690 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 12:55:13,693 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 12:55:13,693 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 12:55:13,878 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 12:55:14,728 - AVRO_setup_logger - INFO - 🛑 Session 3517213143846954 closed and audit updated.
2025-07-21 13:01:16,930 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 13:01:16,935 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 13:01:16,935 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 13:01:16,935 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 13:01:16
2025-07-21 13:01:16,935 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 13:01:16,975 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 13:01:19,195 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 13:01:19,391 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143846958  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 13:01:19.611000-07:00 2999-01-01
2025-07-21 13:01:19,393 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 13:01:19,393 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 13:01:20,985 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 13:01:21,337 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:01:21,342 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:01:21,346 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 13:01:21,350 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 13:01:21,353 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 13:01:21,356 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 13:01:21,360 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 13:01:21,523 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:01:21,523 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:01:21,524 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:01:21,524 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:01:21,525 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:01:21,525 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 13:01:21,526 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 13:01:21,528 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 13:01:21,529 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 13:01:21,531 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 13:01:21,532 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 13:01:21,533 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 13:01:21,535 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 13:01:21,599 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:01:21,600 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:01:21,600 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 13:01:22,840 - AVRO_setup_logger - DEBUG - 📤 Writing 1000 rows from df to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/  with columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:01:24,467 - AVRO_setup_logger - DEBUG - ✅ Rows unloaded to temp stage: 1000, Bytes in: 68257, Bytes out: 22642
2025-07-21 13:01:25,801 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/
2025-07-21 13:01:26,722 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 13:01:26,722 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 13:01:26,827 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 13:01:26,879 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.94 seconds
2025-07-21 13:01:27,133 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 13:01:27,133 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 13:01:27,133 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 13:01:27,135 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 13:01:27,283 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 13:01:28,406 - AVRO_setup_logger - INFO - 🛑 Session 3517213143846958 closed and audit updated.
2025-07-21 13:18:12,182 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 13:18:12,184 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 13:18:12,184 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 13:18:12,184 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 13:18:12
2025-07-21 13:18:12,185 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 13:19:44,262 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 13:19:44,262 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 13:19:44,262 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 13:19:44,262 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 13:19:44
2025-07-21 13:19:44,270 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 13:19:44,311 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 13:19:47,322 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 13:19:47,554 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143830586  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 13:19:47.702000-07:00 2999-01-01
2025-07-21 13:19:47,554 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 13:19:47,554 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 13:19:49,256 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 13:19:49,473 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:19:49,474 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:19:49,476 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 13:19:49,480 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 13:19:49,483 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 13:19:49,486 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 13:19:49,489 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 13:19:49,576 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:19:49,576 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:19:49,576 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:19:49,577 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:19:49,577 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:19:49,577 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 13:19:49,578 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 13:19:49,579 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 13:19:49,580 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 13:19:49,581 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 13:19:49,582 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 13:19:49,582 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 13:19:49,583 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 13:19:49,678 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:19:49,678 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:19:49,680 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 13:19:52,779 - AVRO_setup_logger - DEBUG - ✅ Rows unloaded to temp stage: 1000, Bytes in: 68257, Bytes out: 22642
2025-07-21 13:19:54,125 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 13:19:55,436 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 13:19:55,437 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 13:19:55,512 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 13:19:55,556 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 11.29 seconds
2025-07-21 13:19:55,728 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 13:19:55,728 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 13:19:55,728 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 13:19:55,728 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 13:19:55,926 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 13:19:56,536 - AVRO_setup_logger - INFO - 🛑 Session 3517213143830586 closed and audit updated.
2025-07-21 13:22:43,886 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 13:22:43,886 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 13:22:43,887 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 13:22:43,887 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 13:22:43
2025-07-21 13:22:43,888 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 13:22:43,925 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 13:22:46,247 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 13:22:46,495 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143806002  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 13:22:46.650000-07:00 2999-01-01
2025-07-21 13:22:46,495 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 13:22:46,496 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 13:22:47,993 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 13:22:48,153 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:22:48,153 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:22:48,153 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 13:22:48,153 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 13:22:48,171 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 13:22:48,176 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 13:22:48,180 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 13:22:48,264 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:22:48,265 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:22:48,265 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:22:48,266 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:22:48,267 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:22:48,268 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 13:22:48,277 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 13:22:48,281 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 13:22:48,285 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 13:22:48,287 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 13:22:48,290 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 13:22:48,293 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 13:22:48,295 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 13:22:48,465 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:22:48,466 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:22:48,466 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 13:22:50,822 - AVRO_setup_logger - DEBUG - ✅ Rows unloaded to temp stage: 1000, Bytes in: 68257, Bytes out: 22642
2025-07-21 13:22:52,665 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 13:22:53,701 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 13:22:53,702 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 13:22:53,791 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 13:22:53,836 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.95 seconds
2025-07-21 13:22:54,099 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 13:22:54,100 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 13:22:54,100 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 13:22:54,102 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 13:22:54,252 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 13:22:55,429 - AVRO_setup_logger - INFO - 🛑 Session 3517213143806002 closed and audit updated.
2025-07-21 13:29:25,720 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 13:29:25,720 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 13:29:25,720 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 13:29:25,720 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 13:29:25
2025-07-21 13:29:25,720 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 13:29:25,776 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 13:29:27,638 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 13:29:27,897 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143842854  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 13:29:28.030000-07:00 2999-01-01
2025-07-21 13:29:27,898 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 13:29:27,898 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 13:29:30,080 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 13:29:30,224 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:29:30,224 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:29:30,227 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 13:29:30,231 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 13:29:30,234 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 13:29:30,237 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 13:29:30,241 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 13:29:30,340 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:29:30,341 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:29:30,342 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:29:30,342 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:29:30,343 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:29:30,344 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 13:29:30,346 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 13:29:30,349 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 13:29:30,351 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 13:29:30,353 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 13:29:30,356 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 13:29:30,359 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 13:29:30,361 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 13:29:30,423 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:29:30,424 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:29:30,424 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 13:29:32,939 - AVRO_setup_logger - INFO - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:29:34,279 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 13:29:35,202 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 13:29:35,203 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 13:29:35,256 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 13:29:35,353 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.63 seconds
2025-07-21 13:29:35,815 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 13:29:35,816 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 13:29:35,817 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 13:29:35,817 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 13:29:35,964 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 13:29:36,529 - AVRO_setup_logger - INFO - 🛑 Session 3517213143842854 closed and audit updated.
2025-07-21 13:59:04,790 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 13:59:04,790 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 13:59:04,791 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 13:59:04,791 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 13:59:04
2025-07-21 13:59:04,791 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 13:59:04,840 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 13:59:07,858 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 13:59:08,104 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143834654  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 13:59:08.255000-07:00 2999-01-01
2025-07-21 13:59:08,105 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 13:59:08,105 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 13:59:10,110 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 13:59:10,314 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:59:10,314 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:59:10,316 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 13:59:10,318 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 13:59:10,320 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 13:59:10,322 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 13:59:10,324 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 13:59:10,365 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:59:10,365 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:59:10,365 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 13:59:10,367 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:59:10,367 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 13:59:10,368 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 13:59:10,369 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 13:59:10,372 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 13:59:10,373 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 13:59:10,375 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 13:59:10,376 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 13:59:10,377 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 13:59:10,453 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:59:10,453 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:59:10,453 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 13:59:13,385 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 13:59:14,552 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 13:59:16,483 - AVRO_setup_logger - INFO - 🛑 Session 3517213143834654 closed and audit updated.
2025-07-21 13:59:16,822 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: 'QueryRecord' object has no attribute 'query_tag'
2025-07-21 14:00:56,253 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 14:00:56,253 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 14:00:56,253 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 14:00:56,253 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 14:00:56
2025-07-21 14:00:56,253 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 14:00:56,301 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 14:00:57,972 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 14:00:58,088 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143851066  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 14:00:58.377000-07:00 2999-01-01
2025-07-21 14:00:58,089 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 14:00:58,089 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 14:00:59,781 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 14:00:59,920 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:00:59,920 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:00:59,920 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 14:00:59,920 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 14:00:59,920 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 14:00:59,925 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 14:00:59,925 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 14:00:59,986 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:00:59,988 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:00:59,988 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:00:59,989 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:00:59,989 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 14:00:59,991 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 14:00:59,992 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 14:00:59,994 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 14:00:59,996 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 14:00:59,997 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 14:00:59,999 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 14:00:59,999 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 14:01:00,086 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:01:00,086 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:01:00,086 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 14:01:02,649 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:01:03,725 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 14:01:06,235 - AVRO_setup_logger - INFO - 🛑 Session 3517213143851066 closed and audit updated.
2025-07-21 14:01:06,474 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: 'QueryRecord' object has no attribute 'query_tag'
2025-07-21 14:04:00,934 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 14:04:00,935 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 14:04:00,935 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 14:04:00,935 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 14:04:00
2025-07-21 14:04:00,935 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 14:04:00,971 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 14:04:03,385 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 14:04:03,603 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143842858  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 14:04:03.784000-07:00 2999-01-01
2025-07-21 14:04:03,603 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 14:04:03,603 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 14:04:05,218 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 14:04:05,553 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:04:05,553 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:04:05,553 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 14:04:05,553 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 14:04:05,553 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 14:04:05,553 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 14:04:05,553 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 14:04:05,637 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:04:05,637 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:04:05,638 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:04:05,638 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:04:05,638 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 14:04:05,638 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 14:04:05,638 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 14:04:05,638 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 14:04:05,638 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 14:04:05,638 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 14:04:05,643 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 14:04:05,644 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 14:04:05,757 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:04:05,758 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:04:05,758 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 14:04:07,908 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:04:08,961 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 14:04:10,555 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 14:04:10,556 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 14:04:10,609 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 14:04:10,696 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.76 seconds
2025-07-21 14:04:10,964 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 14:04:10,964 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 14:04:10,965 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 14:04:10,965 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 14:04:11,270 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 14:04:11,786 - AVRO_setup_logger - INFO - 🛑 Session 3517213143842858 closed and audit updated.
2025-07-21 14:10:29,374 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 14:10:29,374 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 14:10:29,375 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 14:10:29,375 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 14:10:29
2025-07-21 14:10:29,375 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 14:10:29,407 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 14:10:31,287 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 14:10:31,412 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143806006  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 14:10:31.686000-07:00 2999-01-01
2025-07-21 14:10:31,413 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 14:10:31,413 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 14:10:32,652 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 14:10:32,814 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:10:32,814 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:10:32,817 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 14:10:32,819 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 14:10:32,819 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 14:10:32,819 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 14:10:32,819 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 14:10:33,427 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:10:33,428 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:10:33,429 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:10:33,429 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:10:33,430 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 14:10:33,433 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 14:10:33,436 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 14:10:33,438 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 14:10:33,441 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 14:10:33,443 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 14:10:33,446 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 14:10:33,448 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 14:10:33,530 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:10:33,531 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:10:33,532 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 14:10:36,184 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:10:37,271 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 14:10:38,651 - AVRO_setup_logger - INFO - 🛑 Session 3517213143806006 closed and audit updated.
2025-07-21 14:10:38,901 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: 'QueryHistory' object is not iterable
2025-07-21 14:13:25,700 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 14:13:25,700 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 14:13:25,700 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 14:13:25,700 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 14:13:25
2025-07-21 14:13:25,701 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 14:13:25,738 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 14:13:27,817 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 14:13:27,918 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143838750  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 14:13:28.219000-07:00 2999-01-01
2025-07-21 14:13:27,918 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 14:13:27,918 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 14:13:29,352 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 14:13:29,451 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:13:29,451 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:13:29,451 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 14:13:29,451 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 14:13:29,451 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 14:13:29,451 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 14:13:29,459 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 14:13:29,503 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:13:29,503 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:13:29,503 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:13:29,504 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:13:29,504 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 14:13:29,505 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 14:13:29,506 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 14:13:29,507 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 14:13:29,508 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 14:13:29,510 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 14:13:29,510 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 14:13:29,512 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 14:13:29,597 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:13:29,598 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:13:29,598 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 14:13:32,322 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:13:33,292 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 14:13:34,395 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-21 14:13:34,395 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-21 14:13:34,471 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-21 14:13:34,522 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 8.82 seconds
2025-07-21 14:13:34,780 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 14:13:34,781 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 14:13:34,781 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 14:13:34,782 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 14:13:34,917 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 14:13:35,496 - AVRO_setup_logger - INFO - 🛑 Session 3517213143838750 closed and audit updated.
2025-07-21 14:16:44,769 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 14:16:44,770 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 14:16:44,770 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 14:16:44,770 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 14:16:44
2025-07-21 14:16:44,771 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 14:16:44,807 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 14:16:46,472 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 14:16:46,593 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143826490  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 14:16:46.872000-07:00 2999-01-01
2025-07-21 14:16:46,593 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 14:16:46,593 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 14:16:48,007 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 14:16:48,147 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:16:48,147 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:16:48,152 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 14:16:48,155 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 14:16:48,157 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 14:16:48,158 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 14:16:48,159 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 14:16:48,212 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:16:48,213 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:16:48,213 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:16:48,213 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:16:48,213 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 14:16:48,215 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 14:16:48,216 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 14:16:48,217 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 14:16:48,220 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 14:16:48,223 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 14:16:48,224 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 14:16:48,226 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 14:16:48,314 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:16:48,314 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:16:48,314 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 14:16:50,668 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:16:51,736 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 14:16:52,733 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdd83c-0206-0823-000c-7ee3000cf1a6
2025-07-21 14:16:53,334 - AVRO_setup_logger - INFO - 🛑 Session 3517213143826490 closed and audit updated.
2025-07-21 14:16:53,576 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: can only concatenate str (not "NoneType") to str
2025-07-21 14:20:42,979 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 14:20:42,980 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 14:20:42,980 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 14:20:42,981 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 14:20:42
2025-07-21 14:20:42,981 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 14:20:43,024 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 14:20:45,016 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 14:20:45,388 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143846962  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 14:20:45.462000-07:00 2999-01-01
2025-07-21 14:20:45,422 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 14:20:45,422 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 14:20:46,645 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 14:20:46,809 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:20:46,809 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:20:46,812 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 14:20:46,815 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 14:20:46,820 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 14:20:46,831 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 14:20:46,834 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 14:20:46,901 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 14:20:46,901 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 14:20:46,965 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:20:46,965 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:20:46,966 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 14:20:49,059 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:20:50,700 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 14:20:52,018 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdd840-0206-07ba-000c-7ee3000cd186
2025-07-21 14:20:52,744 - AVRO_setup_logger - INFO - 🛑 Session 3517213143846962 closed and audit updated.
2025-07-21 14:20:53,531 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: can only concatenate str (not "NoneType") to str
2025-07-21 14:31:07,534 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-21 14:31:07,534 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-21 14:31:07,534 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-21 14:31:07,534 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-21 14:31:07
2025-07-21 14:31:07,550 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-21 14:31:07,589 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-21 14:31:10,582 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-21 14:31:10,752 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143842862  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-21 14:31:11.028000-07:00 2999-01-01
2025-07-21 14:31:10,753 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-21 14:31:10,753 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-21 14:31:12,150 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-21 14:31:12,476 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:31:12,477 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:31:12,479 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-21 14:31:12,483 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-21 14:31:12,486 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-21 14:31:12,489 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-21 14:31:12,493 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-21 14:31:12,577 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:31:12,578 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:31:12,579 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-21 14:31:12,579 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:31:12,580 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-21 14:31:12,583 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-21 14:31:12,586 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-21 14:31:12,589 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-21 14:31:12,592 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-21 14:31:12,594 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-21 14:31:12,597 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-21 14:31:12,599 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-21 14:31:12,730 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:31:12,731 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:31:12,732 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-21 14:31:15,955 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-21 14:31:17,218 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-21 14:31:18,817 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdd84b-0206-06b5-000c-7ee3000c12f2
2025-07-21 14:31:18,872 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bdd84b-0206-06b5-000c-7ee3000c12f2'
        )
    )
2025-07-21 14:31:19,752 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-21 14:31:19,753 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 12.2 seconds
2025-07-21 14:31:20,151 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 14:31:20,151 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-21 14:31:20,151 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-21 14:31:20,151 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-21 14:31:20,603 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-21 14:31:21,071 - AVRO_setup_logger - INFO - 🛑 Session 3517213143842862 closed and audit updated.
2025-07-22 06:11:38,374 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 06:11:38,374 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 06:11:38,374 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 06:11:38,374 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 06:11:38
2025-07-22 06:11:38,374 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 06:11:38,418 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 06:11:46,245 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 06:11:46,594 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143846966  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 06:11:46.806000-07:00 2999-01-01
2025-07-22 06:11:46,594 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 06:11:46,595 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 06:11:48,291 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 06:11:48,647 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 06:11:48,647 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 06:11:48,653 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 06:11:48,653 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 06:11:48,661 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 06:11:48,665 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 06:11:48,665 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 06:11:48,749 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 06:11:48,752 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 06:11:48,753 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 06:11:48,753 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 06:11:48,754 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 06:11:48,757 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 06:11:48,760 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 06:11:48,763 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 06:11:48,765 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 06:11:48,768 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 06:11:48,771 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 06:11:48,773 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 06:11:48,851 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 06:11:48,851 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 06:11:48,852 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-22 06:11:51,717 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 06:11:53,302 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 06:11:55,007 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bddbf7-0206-0df7-000c-7ee3000d6016
2025-07-22 06:11:55,102 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bddbf7-0206-0df7-000c-7ee3000d6016'
        )
    )
2025-07-22 06:11:55,924 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 06:11:55,924 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 17.55 seconds
2025-07-22 06:11:56,666 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 06:11:56,667 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 06:11:56,668 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 06:11:56,668 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 06:11:57,107 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 06:11:57,965 - AVRO_setup_logger - INFO - 🛑 Session 3517213143846966 closed and audit updated.
2025-07-22 07:48:20,247 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 07:48:20,249 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 07:48:20,249 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 07:48:20,249 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 07:48:20
2025-07-22 07:48:20,249 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 07:48:20,300 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 07:48:23,733 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 07:48:24,102 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143838762  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 07:48:24.293000-07:00 2999-01-01
2025-07-22 07:48:24,102 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 07:48:24,112 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 07:48:27,112 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 07:48:27,316 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 07:48:27,317 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 07:48:27,319 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 07:48:27,321 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 07:48:27,321 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 07:48:27,324 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 07:48:27,324 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 07:48:27,415 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 07:48:27,415 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:48:27,415 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 07:48:27,415 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:48:27,415 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 07:48:27,415 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 07:48:27,430 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 07:48:27,433 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 07:48:27,435 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 07:48:27,436 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 07:48:27,436 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 07:48:27,436 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 07:48:27,520 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:48:27,522 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:48:27,522 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-22 07:48:30,079 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:48:31,766 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 07:48:33,666 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bddc58-0206-0823-000c-7ee3000cf212
2025-07-22 07:48:33,667 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bddc58-0206-0823-000c-7ee3000cf212
2025-07-22 07:48:33,710 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bddc58-0206-0823-000c-7ee3000cf212'
        )
    )
2025-07-22 07:48:34,807 - AVRO_setup_logger - INFO - 🛑 Session 3517213143838762 closed and audit updated.
2025-07-22 07:48:35,098 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: (1304): 01bddc58-0206-07ba-000c-7ee3000cd1be: 002018 (22023): SQL compilation error:
Invalid argument [Provided job UUID not for a COPY job] for table function. Table function argument is required to be a constant.
2025-07-22 07:52:54,833 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 07:52:54,833 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 07:52:54,833 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 07:52:54,833 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 07:52:54
2025-07-22 07:52:54,833 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 07:52:54,884 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 07:52:56,537 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 07:52:56,876 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143875590  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 07:52:57.181000-07:00 2999-01-01
2025-07-22 07:52:56,878 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 07:52:56,878 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 07:52:58,373 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 07:52:58,482 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 07:52:58,482 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 07:52:58,496 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 07:52:58,498 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 07:52:58,500 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 07:52:58,501 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 07:52:58,504 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 07:52:58,566 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 07:52:58,566 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:52:58,566 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 07:52:58,566 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:52:58,566 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 07:52:58,566 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 07:52:58,566 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 07:52:58,581 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 07:52:58,583 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 07:52:58,584 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 07:52:58,586 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 07:52:58,587 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 07:52:58,678 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:52:58,679 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:52:58,679 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-22 07:53:01,754 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 07:53:03,536 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 07:53:04,823 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bddc5d-0206-0d70-000c-7ee3000d503e
2025-07-22 07:53:04,823 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bddc5d-0206-0d70-000c-7ee3000d503e
2025-07-22 07:53:04,871 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bddc5d-0206-0d70-000c-7ee3000d503e'
        )
    )
2025-07-22 07:53:06,086 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 07:53:06,086 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 11.25 seconds
2025-07-22 07:53:06,488 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 07:53:06,488 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 07:53:06,488 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 07:53:06,492 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 07:53:07,104 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 07:53:07,525 - AVRO_setup_logger - INFO - 🛑 Session 3517213143875590 closed and audit updated.
2025-07-22 09:31:37,048 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 09:31:37,048 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 09:31:37,048 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 09:31:37,048 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 09:31:37
2025-07-22 09:31:37,048 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 09:31:37,094 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 09:31:44,605 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 09:31:44,850 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143875594  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 09:31:45.199000-07:00 2999-01-01
2025-07-22 09:31:44,852 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 09:31:44,852 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 09:31:46,957 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 09:31:47,211 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 09:31:47,211 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 09:31:47,211 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 09:31:47,216 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 09:31:47,216 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 09:31:47,216 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 09:31:47,216 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 09:31:47,403 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 09:31:47,404 - AVRO_setup_logger - DEBUG - ✅ c ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 09:31:47,404 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 09:31:47,405 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 09:31:47,405 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 09:31:47,406 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 09:31:47,407 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 09:31:47,407 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 09:31:47,408 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 09:31:47,409 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 09:31:47,410 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 09:31:47,410 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 09:31:47,471 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 09:31:47,471 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 09:31:47,471 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-22 09:31:50,747 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 09:31:51,976 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 09:31:53,511 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bddcbf-0206-07ba-000c-7ee3000cd1ea
2025-07-22 09:31:53,511 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bddcbf-0206-07ba-000c-7ee3000cd1ea
2025-07-22 09:31:53,548 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bddcbf-0206-07ba-000c-7ee3000cd1ea'
        )
    )
2025-07-22 09:31:54,270 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 09:31:54,270 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 17.22 seconds
2025-07-22 09:31:55,557 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 09:31:55,557 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 09:31:55,557 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 09:31:55,562 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 09:31:56,250 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 09:31:57,034 - AVRO_setup_logger - INFO - 🛑 Session 3517213143875594 closed and audit updated.
2025-07-22 11:01:02,892 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 11:01:02,892 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 11:01:02,892 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 11:01:02,892 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 11:01:02
2025-07-22 11:01:02,892 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 11:01:02,944 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 11:01:06,908 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 11:01:07,263 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143879686  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 11:01:07.529000-07:00 2999-01-01
2025-07-22 11:01:07,263 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 11:01:07,263 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 11:01:09,803 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 11:01:10,082 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 11:01:10,083 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 11:01:10,084 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 11:01:10,084 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 11:01:10,086 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 11:01:10,089 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 11:01:10,091 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 11:01:10,135 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 11:01:10,135 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:01:10,135 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 11:01:10,135 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:01:10,135 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 11:01:10,137 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 11:01:10,139 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 11:01:10,139 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 11:01:10,139 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 11:01:10,142 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 11:01:10,143 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 11:01:10,144 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 11:01:10,239 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:01:10,239 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:01:10,239 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-22 11:01:14,282 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:01:15,859 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 11:01:17,492 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bddd19-0206-07ba-000c-7ee3000cd1fa
2025-07-22 11:01:17,492 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bddd19-0206-07ba-000c-7ee3000cd1fa
2025-07-22 11:01:17,556 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bddd19-0206-07ba-000c-7ee3000cd1fa'
        )
    )
2025-07-22 11:01:18,634 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 11:01:18,634 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 15.74 seconds
2025-07-22 11:01:19,193 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 11:01:19,193 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 11:01:19,194 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 11:01:19,194 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 11:01:20,140 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 11:01:20,861 - AVRO_setup_logger - INFO - 🛑 Session 3517213143879686 closed and audit updated.
2025-07-22 11:02:56,250 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 11:02:56,250 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 11:02:56,250 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 11:02:56,251 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 11:02:56
2025-07-22 11:02:56,251 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 11:02:56,303 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 11:02:58,727 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 11:02:58,835 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143879690  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 11:02:59.348000-07:00 2999-01-01
2025-07-22 11:02:58,839 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 11:02:58,839 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 11:03:00,511 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 11:03:00,716 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 11:03:00,717 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 11:03:00,717 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 11:03:00,719 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 11:03:00,722 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 11:03:00,722 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 11:03:00,722 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 11:03:00,817 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 11:03:00,817 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:03:00,817 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 11:03:00,817 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:03:00,817 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 11:03:00,817 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 11:03:00,817 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 11:03:00,817 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 11:03:00,817 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 11:03:00,823 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 11:03:00,824 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 11:03:00,824 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 11:03:00,978 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:03:00,978 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:03:00,984 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-22 11:03:03,744 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 11:03:05,024 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 11:03:06,230 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bddd1b-0206-08dd-000c-7ee3000cc232
2025-07-22 11:03:06,231 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bddd1b-0206-08dd-000c-7ee3000cc232
2025-07-22 11:03:06,304 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bddd1b-0206-08dd-000c-7ee3000cc232'
        )
    )
2025-07-22 11:03:07,446 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 11:03:07,446 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 11.2 seconds
2025-07-22 11:03:07,943 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 11:03:07,943 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 11:03:07,943 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 11:03:07,943 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 11:03:08,355 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 11:03:09,006 - AVRO_setup_logger - INFO - 🛑 Session 3517213143879690 closed and audit updated.
2025-07-22 16:01:16,844 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:01:16,844 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:01:16,844 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:01:16,844 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:01:16
2025-07-22 16:01:16,844 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:01:16,901 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:01:21,436 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:01:21,707 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143891978  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:01:22.148000-07:00 2999-01-01
2025-07-22 16:01:21,707 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:01:21,707 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:01:23,454 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:01:23,923 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:01:23,923 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:01:23,923 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:01:23,923 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:01:23,923 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:01:23,923 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:01:23,941 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:01:24,018 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:01:24,019 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:01:24,019 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:01:24,020 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:01:24,021 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:01:24,026 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:01:24,028 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:01:24,030 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:01:24,032 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:01:24,033 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:01:24,035 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:01:24,036 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:01:24,181 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:01:24,181 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:01:24,181 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-22 16:01:24,523 - AVRO_setup_logger - INFO - 🛑 Session 3517213143891978 closed and audit updated.
2025-07-22 16:01:24,891 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: name 'config' is not defined
2025-07-22 16:06:42,527 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:06:42,527 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:06:42,527 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:06:42,527 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:06:42
2025-07-22 16:06:42,527 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:06:42,590 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:06:45,103 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:06:45,396 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143879718  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:06:45.824000-07:00 2999-01-01
2025-07-22 16:06:45,396 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:06:45,396 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:06:47,557 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:06:47,770 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:06:47,770 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:06:47,770 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:06:47,779 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:06:47,783 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:06:47,788 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:06:47,792 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:06:47,874 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:06:47,874 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:06:47,874 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:06:47,874 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:06:47,874 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:06:47,874 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:06:47,874 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:06:47,884 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:06:47,886 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:06:47,889 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:06:47,891 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:06:47,893 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:06:47,975 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:06:47,975 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:06:47,977 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-22 16:06:48,419 - AVRO_setup_logger - INFO - 🛑 Session 3517213143879718 closed and audit updated.
2025-07-22 16:06:48,790 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: validate_config_against_schema_ref() takes 3 positional arguments but 4 were given
2025-07-22 16:14:09,020 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:14:09,020 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:14:09,020 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:14:09,020 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:14:09
2025-07-22 16:14:09,020 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:14:09,091 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:14:11,167 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:14:11,273 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143896070  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:14:11.879000-07:00 2999-01-01
2025-07-22 16:14:11,273 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:14:11,273 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:14:12,845 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:14:12,940 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:14:12,940 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:14:12,956 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:14:12,958 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:14:12,961 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:14:12,962 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:14:12,963 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:14:13,064 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:14:13,064 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:14:13,064 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:14:13,065 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:14:13,065 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:14:13,066 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:14:13,068 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:14:13,069 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:14:13,070 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:14:13,071 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:14:13,072 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:14:13,073 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:14:13,148 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:14:13,148 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:14:13,149 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-22 16:14:13,930 - AVRO_setup_logger - INFO - 🛑 Session 3517213143896070 closed and audit updated.
2025-07-22 16:14:14,173 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: validate_config_against_schema_ref() takes 3 positional arguments but 4 were given
2025-07-22 16:22:38,386 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:22:38,386 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:22:38,386 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:22:38,388 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:22:38
2025-07-22 16:22:38,388 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:22:38,465 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:22:40,800 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:22:41,087 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143896074  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:22:41.530000-07:00 2999-01-01
2025-07-22 16:22:41,087 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:22:41,087 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:22:43,064 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:22:43,218 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:22:43,219 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:22:43,221 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:22:43,225 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:22:43,228 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:22:43,231 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:22:43,234 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:22:43,311 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:22:43,311 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:22:43,311 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:22:43,311 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:22:43,311 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:22:43,311 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:22:43,311 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:22:43,311 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:22:43,323 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:22:43,325 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:22:43,327 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:22:43,328 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:22:43,405 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:22:43,405 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:22:43,406 - AVRO_setup_logger - INFO - ✅ All df columns match target columns.
2025-07-22 16:22:43,780 - AVRO_setup_logger - INFO - 🛑 Session 3517213143896074 closed and audit updated.
2025-07-22 16:22:44,087 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: name 'schema_registry' is not defined
2025-07-22 16:25:52,944 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:25:52,944 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:25:52,944 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:25:52,944 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:25:52
2025-07-22 16:25:52,944 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:25:52,991 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:25:54,966 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:25:55,081 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143875610  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:25:55.696000-07:00 2999-01-01
2025-07-22 16:25:55,082 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:25:55,082 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:25:58,235 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:25:58,441 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:25:58,441 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:25:58,441 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:25:58,441 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:25:58,441 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:25:58,450 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:25:58,452 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:25:58,494 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:25:58,494 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:25:58,494 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:25:58,494 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:25:58,494 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:25:58,494 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:25:58,494 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:25:58,494 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:25:58,494 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:25:58,502 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:25:58,504 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:25:58,505 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:25:58,573 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:25:58,573 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:25:58,573 - AVRO_setup_logger - INFO - ✅ All df columns match target columns.
2025-07-22 16:25:58,573 - AVRO_setup_logger - WARNING - ⚠️ No schema found for reference: emp_details_avro_cls
2025-07-22 16:26:01,016 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:26:02,434 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 16:26:03,768 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bdde5e-0206-0d17-000c-7ee3000d70d2
2025-07-22 16:26:03,769 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdde5e-0206-0d17-000c-7ee3000d70d2
2025-07-22 16:26:03,826 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bdde5e-0206-0d17-000c-7ee3000d70d2'
        )
    )
2025-07-22 16:26:04,686 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 16:26:04,686 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 11.74 seconds
2025-07-22 16:26:05,348 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:26:05,348 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:26:05,348 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 16:26:05,348 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 16:26:05,887 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 16:26:06,327 - AVRO_setup_logger - INFO - 🛑 Session 3517213143875610 closed and audit updated.
2025-07-22 16:31:07,633 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:31:07,633 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:31:07,633 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:31:07,639 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:31:07
2025-07-22 16:31:07,639 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:31:07,678 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:31:09,742 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:31:09,872 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143846990  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:31:10.470000-07:00 2999-01-01
2025-07-22 16:31:09,888 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:31:09,889 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:31:11,188 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:31:11,324 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:31:11,325 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:31:11,326 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:31:11,327 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:31:11,328 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:31:11,329 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:31:11,330 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:31:11,420 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:31:11,421 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:31:11,421 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:31:11,421 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:31:11,421 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:31:11,422 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:31:11,423 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:31:11,424 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:31:11,425 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:31:11,426 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:31:11,427 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:31:11,427 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:31:11,516 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:31:11,516 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:31:11,516 - AVRO_setup_logger - INFO - ✅ All df columns match target columns.
2025-07-22 16:31:11,516 - AVRO_setup_logger - WARNING - ⚠️ No schema found for reference: emp_details_avro_cls_V1_0
2025-07-22 16:31:13,851 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:31:15,111 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 16:31:16,293 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bdde63-0206-0df7-000c-7ee3000d60e2
2025-07-22 16:31:16,294 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdde63-0206-0df7-000c-7ee3000d60e2
2025-07-22 16:31:16,344 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bdde63-0206-0df7-000c-7ee3000d60e2'
        )
    )
2025-07-22 16:31:17,140 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 16:31:17,140 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.5 seconds
2025-07-22 16:31:17,554 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:31:17,554 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:31:17,554 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 16:31:17,569 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 16:31:17,979 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 16:31:18,573 - AVRO_setup_logger - INFO - 🛑 Session 3517213143846990 closed and audit updated.
2025-07-22 16:33:16,294 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:33:16,294 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:33:16,304 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:33:16,304 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:33:16
2025-07-22 16:33:16,305 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:33:16,347 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:33:18,163 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:33:18,307 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143887894  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:33:18.884000-07:00 2999-01-01
2025-07-22 16:33:18,308 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:33:18,308 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:33:19,587 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:33:19,738 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:33:19,740 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:33:19,742 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:33:19,745 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:33:19,749 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:33:19,751 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:33:19,753 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:33:19,829 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:33:19,829 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:33:19,830 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:33:19,830 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:33:19,830 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:33:19,831 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:33:19,831 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:33:19,831 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:33:19,831 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:33:19,835 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:33:19,836 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:33:19,838 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:33:19,933 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:33:19,934 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:33:19,934 - AVRO_setup_logger - INFO - ✅ All df columns match target columns.
2025-07-22 16:33:19,935 - AVRO_setup_logger - WARNING - ⚠️ No schema found for reference: emp_details_avro_cls@V1_0
2025-07-22 16:33:22,677 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:33:23,730 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 16:33:24,719 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bdde65-0206-0df7-000c-7ee3000d60fe
2025-07-22 16:33:24,719 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdde65-0206-0df7-000c-7ee3000d60fe
2025-07-22 16:33:24,808 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bdde65-0206-0df7-000c-7ee3000d60fe'
        )
    )
2025-07-22 16:33:25,467 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 16:33:25,467 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.16 seconds
2025-07-22 16:33:25,934 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:33:25,934 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:33:25,934 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 16:33:25,934 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 16:33:26,660 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 16:33:27,569 - AVRO_setup_logger - INFO - 🛑 Session 3517213143887894 closed and audit updated.
2025-07-22 16:35:52,777 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:35:52,777 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:35:52,778 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:35:52,778 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:35:52
2025-07-22 16:35:52,779 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:35:52,817 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:35:54,835 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:35:54,942 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143891982  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:35:55.556000-07:00 2999-01-01
2025-07-22 16:35:54,942 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:35:54,942 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:35:56,393 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:35:56,557 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:35:56,557 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:35:56,557 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:35:56,557 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:35:56,557 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:35:56,557 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:35:56,557 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:35:56,667 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:35:56,667 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:35:56,668 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:35:56,668 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:35:56,668 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:35:56,670 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:35:56,671 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:35:56,671 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:35:56,672 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:35:56,673 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:35:56,675 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:35:56,676 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:35:56,795 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:35:56,795 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:35:56,796 - AVRO_setup_logger - INFO - ✅ All df columns match target columns.
2025-07-22 16:35:56,796 - AVRO_setup_logger - WARNING - ⚠️ No schema found for reference: emp_details_avro_cls@v1_0
2025-07-22 16:35:59,124 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:36:00,288 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 16:36:01,503 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bdde68-0206-0d17-000c-7ee3000d7112
2025-07-22 16:36:01,503 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdde68-0206-0d17-000c-7ee3000d7112
2025-07-22 16:36:01,586 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bdde68-0206-0d17-000c-7ee3000d7112'
        )
    )
2025-07-22 16:36:02,752 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 16:36:02,753 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.97 seconds
2025-07-22 16:36:03,219 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:36:03,219 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:36:03,219 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 16:36:03,219 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 16:36:03,532 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 16:36:03,934 - AVRO_setup_logger - INFO - 🛑 Session 3517213143891982 closed and audit updated.
2025-07-22 16:36:59,369 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:36:59,369 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:36:59,369 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:36:59,371 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:36:59
2025-07-22 16:36:59,371 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:36:59,414 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:37:00,983 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:37:01,125 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143900166  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:37:01.719000-07:00 2999-01-01
2025-07-22 16:37:01,125 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:37:01,125 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:37:02,243 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:37:02,405 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:37:02,405 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:37:02,405 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:37:02,405 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:37:02,405 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:37:02,405 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:37:02,405 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:37:02,522 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:37:02,522 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:37:02,533 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:37:02,640 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:37:02,640 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:37:02,640 - AVRO_setup_logger - INFO - ✅ All df columns match target columns.
2025-07-22 16:37:02,640 - AVRO_setup_logger - WARNING - ⚠️ Columns missing from config: ['DELETEME', 'REGISTRTION']
2025-07-22 16:37:02,640 - AVRO_setup_logger - WARNING - ⚠️ Extra columns in config not found in schema: ['REGISTRATION']
2025-07-22 16:37:05,365 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:37:06,640 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 16:37:07,639 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bdde69-0206-0d17-000c-7ee3000d7136
2025-07-22 16:37:07,639 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdde69-0206-0d17-000c-7ee3000d7136
2025-07-22 16:37:07,684 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bdde69-0206-0d17-000c-7ee3000d7136'
        )
    )
2025-07-22 16:37:08,655 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 16:37:08,655 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.28 seconds
2025-07-22 16:37:09,000 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:37:09,000 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:37:09,000 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 16:37:09,000 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 16:37:09,473 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 16:37:09,878 - AVRO_setup_logger - INFO - 🛑 Session 3517213143900166 closed and audit updated.
2025-07-22 16:40:34,820 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:40:34,820 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:40:34,820 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:40:34,820 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:40:34
2025-07-22 16:40:34,820 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:40:34,872 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:40:36,221 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:40:36,343 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143896078  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:40:36.943000-07:00 2999-01-01
2025-07-22 16:40:36,343 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:40:36,343 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:40:37,656 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:40:37,804 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:40:37,804 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:40:37,804 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:40:37,804 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:40:37,804 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:40:37,804 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:40:37,814 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:40:37,888 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:40:37,888 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:40:37,888 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:40:37,888 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:40:37,888 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:40:37,888 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:40:37,888 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:40:37,888 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:40:37,888 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:40:37,888 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:40:37,901 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:40:37,902 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:40:37,959 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:40:37,960 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:40:37,960 - AVRO_setup_logger - INFO - ✅ All df columns match target columns.
2025-07-22 16:40:37,961 - AVRO_setup_logger - WARNING - ⚠️ Columns missing from config: ['DELETEME']
2025-07-22 16:40:40,016 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:40:41,072 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 16:40:42,055 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bdde6c-0206-0df7-000c-7ee3000d613a
2025-07-22 16:40:42,055 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdde6c-0206-0df7-000c-7ee3000d613a
2025-07-22 16:40:42,095 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bdde6c-0206-0df7-000c-7ee3000d613a'
        )
    )
2025-07-22 16:40:42,989 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 16:40:42,989 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 8.17 seconds
2025-07-22 16:40:43,387 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:40:43,387 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:40:43,387 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 16:40:43,387 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 16:40:43,820 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 16:40:44,531 - AVRO_setup_logger - INFO - 🛑 Session 3517213143896078 closed and audit updated.
2025-07-22 16:42:26,405 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:42:26,405 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:42:26,405 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:42:26,405 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:42:26
2025-07-22 16:42:26,405 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:42:26,458 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:42:28,347 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:42:28,457 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143900170  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:42:29.079000-07:00 2999-01-01
2025-07-22 16:42:28,459 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:42:28,459 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:42:29,933 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:42:30,122 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:42:30,122 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:42:30,122 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:42:30,122 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:42:30,122 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:42:30,137 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:42:30,138 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:42:30,301 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:42:30,302 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:42:30,303 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:42:30,303 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:42:30,303 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:42:30,306 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:42:30,308 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:42:30,310 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:42:30,312 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:42:30,314 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:42:30,316 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:42:30,317 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:42:30,398 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:42:30,399 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:42:30,399 - AVRO_setup_logger - INFO - ✅ All df columns match target columns.
2025-07-22 16:42:30,400 - AVRO_setup_logger - INFO - ✅ Config target columns match schema reference 'emp_details_avro_cls@v1.0' exactly.
2025-07-22 16:42:33,217 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:42:34,234 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 16:42:35,412 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bdde6e-0206-0e58-000c-7ee3000da03a
2025-07-22 16:42:35,416 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdde6e-0206-0e58-000c-7ee3000da03a
2025-07-22 16:42:35,455 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bdde6e-0206-0e58-000c-7ee3000da03a'
        )
    )
2025-07-22 16:42:36,172 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 16:42:36,172 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.77 seconds
2025-07-22 16:42:36,635 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:42:36,635 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:42:36,635 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 16:42:36,635 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 16:42:37,055 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 16:42:37,450 - AVRO_setup_logger - INFO - 🛑 Session 3517213143900170 closed and audit updated.
2025-07-22 16:47:08,117 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:47:08,117 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:47:08,117 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:47:08,117 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:47:08
2025-07-22 16:47:08,117 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:47:08,162 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:47:09,642 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:47:09,858 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143879722  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:47:10.367000-07:00 2999-01-01
2025-07-22 16:47:09,858 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:47:09,858 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:47:11,024 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:47:11,170 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:47:11,170 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:47:11,188 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:47:11,188 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:47:11,188 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:47:11,188 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:47:11,188 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:47:11,272 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:47:11,272 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:47:11,272 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:47:11,272 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:47:11,272 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:47:11,272 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:47:11,290 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:47:11,292 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:47:11,294 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:47:11,297 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:47:11,299 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:47:11,302 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:47:11,372 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:47:11,818 - AVRO_setup_logger - INFO - 🛑 Session 3517213143879722 closed and audit updated.
2025-07-22 16:47:12,101 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: name 'target_column' is not defined
2025-07-22 16:47:59,998 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-22 16:47:59,998 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-22 16:47:59,999 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-22 16:47:59,999 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-22 16:47:59
2025-07-22 16:47:59,999 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-22 16:48:00,041 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-22 16:48:01,600 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-22 16:48:01,680 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143896082  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-22 16:48:02.327000-07:00 2999-01-01
2025-07-22 16:48:01,681 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-22 16:48:01,681 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-22 16:48:02,992 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-22 16:48:03,119 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:48:03,135 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:48:03,138 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-22 16:48:03,138 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-22 16:48:03,138 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-22 16:48:03,138 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-22 16:48:03,138 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-22 16:48:03,435 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:48:03,435 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:48:03,435 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-22 16:48:03,436 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:48:03,436 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-22 16:48:03,438 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-22 16:48:03,438 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-22 16:48:03,438 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-22 16:48:03,438 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-22 16:48:03,438 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-22 16:48:03,438 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-22 16:48:03,438 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-22 16:48:03,506 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:48:03,507 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:48:03,507 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-22 16:48:03,508 - AVRO_setup_logger - INFO - ✅ Config target columns match schema reference 'emp_details_avro_cls@v1.0' exactly.
2025-07-22 16:48:05,549 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-22 16:48:06,629 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-22 16:48:07,605 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bdde74-0206-07ba-000c-7ee3000cd2ea
2025-07-22 16:48:07,605 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bdde74-0206-07ba-000c-7ee3000cd2ea
2025-07-22 16:48:07,650 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bdde74-0206-07ba-000c-7ee3000cd2ea'
        )
    )
2025-07-22 16:48:08,453 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-22 16:48:08,453 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 8.45 seconds
2025-07-22 16:48:08,820 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:48:08,820 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-22 16:48:08,820 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-22 16:48:08,820 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-22 16:48:09,248 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-22 16:48:09,649 - AVRO_setup_logger - INFO - 🛑 Session 3517213143896082 closed and audit updated.
2025-07-23 09:14:14,177 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-23 09:14:14,178 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-23 09:14:14,178 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-23 09:14:14,178 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-23 09:14:14
2025-07-23 09:14:14,178 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-23 09:14:14,224 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-23 09:14:18,302 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-23 09:14:18,545 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143846994  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-23 09:14:19.248000-07:00 2999-01-01
2025-07-23 09:14:18,546 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-23 09:14:18,546 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-23 09:14:21,027 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-23 09:14:21,164 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:14:21,164 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:14:21,164 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-23 09:14:21,164 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-23 09:14:21,164 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-23 09:14:21,164 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-23 09:14:21,178 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-23 09:14:21,267 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:14:21,267 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:14:21,267 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:14:21,267 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:14:21,267 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-23 09:14:21,267 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-23 09:14:21,267 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-23 09:14:21,282 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-23 09:14:21,283 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-23 09:14:21,284 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-23 09:14:21,286 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-23 09:14:21,287 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-23 09:14:21,435 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:14:21,435 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:14:21,435 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-23 09:14:21,435 - AVRO_setup_logger - INFO - 🔍 Validating target columns against schema reference 'emp_details_avro_cls@v1.0' with available versions: ['v1.0']
2025-07-23 09:14:21,435 - AVRO_setup_logger - INFO - ✅ Config target columns match schema reference 'emp_details_avro_cls@v1.0' exactly.
2025-07-23 09:14:25,323 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:14:26,809 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-23 09:14:28,320 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bde24e-0206-0823-000c-7ee3000dd01e
2025-07-23 09:14:28,320 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bde24e-0206-0823-000c-7ee3000dd01e
2025-07-23 09:14:28,399 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bde24e-0206-0823-000c-7ee3000dd01e'
        )
    )
2025-07-23 09:14:29,251 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-23 09:14:29,251 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 15.07 seconds
2025-07-23 09:14:30,240 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:14:30,240 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:14:30,240 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-23 09:14:30,240 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-23 09:14:31,010 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-23 09:14:31,569 - AVRO_setup_logger - INFO - 🛑 Session 3517213143846994 closed and audit updated.
2025-07-23 09:16:11,962 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-23 09:16:11,962 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-23 09:16:11,962 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-23 09:16:11,962 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-23 09:16:11
2025-07-23 09:16:11,962 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-23 09:16:11,999 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-23 09:16:13,871 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-23 09:16:13,992 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143887898  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-23 09:16:14.764000-07:00 2999-01-01
2025-07-23 09:16:13,992 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-23 09:16:13,992 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-23 09:16:15,200 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-23 09:16:15,341 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:16:15,341 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:16:15,341 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-23 09:16:15,341 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-23 09:16:15,341 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-23 09:16:15,341 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-23 09:16:15,341 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-23 09:16:15,405 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:16:15,405 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:16:15,405 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:16:15,405 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:16:15,405 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-23 09:16:15,408 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-23 09:16:15,409 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-23 09:16:15,411 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-23 09:16:15,412 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-23 09:16:15,412 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-23 09:16:15,413 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-23 09:16:15,414 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-23 09:16:15,455 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:16:15,455 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:16:15,455 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-23 09:16:15,455 - AVRO_setup_logger - INFO - 🔍 Validating target columns against schema reference 'emp_details_avro_cls@v1.1' with available versions: ['v1.0']
2025-07-23 09:16:15,455 - AVRO_setup_logger - WARNING - ⚠️ No schema found for reference: emp_details_avro_cls@v1.1
2025-07-23 09:16:18,270 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:16:19,606 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-23 09:16:20,833 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bde250-0206-0823-000c-7ee3000dd036
2025-07-23 09:16:20,833 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bde250-0206-0823-000c-7ee3000dd036
2025-07-23 09:16:20,883 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bde250-0206-0823-000c-7ee3000dd036'
        )
    )
2025-07-23 09:16:21,706 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-23 09:16:21,706 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.74 seconds
2025-07-23 09:16:22,417 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:16:22,417 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:16:22,417 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-23 09:16:22,417 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-23 09:16:22,817 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-23 09:16:23,499 - AVRO_setup_logger - INFO - 🛑 Session 3517213143887898 closed and audit updated.
2025-07-23 09:25:05,597 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-23 09:25:05,599 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-23 09:25:05,599 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-23 09:25:05,599 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-23 09:25:05
2025-07-23 09:25:05,599 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-23 09:25:05,657 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-23 09:25:07,912 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-23 09:25:08,198 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143846998  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-23 09:25:08.817000-07:00 2999-01-01
2025-07-23 09:25:08,198 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-23 09:25:08,198 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-23 09:25:09,719 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-23 09:25:09,949 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:25:09,949 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:25:09,949 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-23 09:25:09,964 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-23 09:25:09,970 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-23 09:25:09,973 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-23 09:25:09,975 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-23 09:25:10,040 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:25:10,041 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:25:10,041 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:25:10,042 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:25:10,043 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-23 09:25:10,045 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-23 09:25:10,047 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-23 09:25:10,049 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-23 09:25:10,050 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-23 09:25:10,051 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-23 09:25:10,052 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-23 09:25:10,052 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-23 09:25:10,190 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:25:10,190 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:25:10,191 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-23 09:25:10,191 - AVRO_setup_logger - INFO - 🔍 Validating target columns against schema reference 'emp_details_avro_cls@v1.1' with available versions: ['v1.0']
2025-07-23 09:25:10,192 - AVRO_setup_logger - WARNING - ⚠️ Schema version 'v1.1' not found for 'emp_details_avro_cls'. Available versions: ['v1.0']
2025-07-23 09:25:10,971 - AVRO_setup_logger - INFO - 🛑 Session 3517213143846998 closed and audit updated.
2025-07-23 09:25:11,266 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: Schema version 'v1.1' not found for 'emp_details_avro_cls'.
2025-07-23 09:28:16,343 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-23 09:28:16,343 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-23 09:28:16,343 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-23 09:28:16,343 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-23 09:28:16
2025-07-23 09:28:16,343 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-23 09:28:16,383 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-23 09:28:18,283 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-23 09:28:18,370 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143896086  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-23 09:28:19.182000-07:00 2999-01-01
2025-07-23 09:28:18,371 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-23 09:28:18,371 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-23 09:28:19,991 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-23 09:28:20,208 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:28:20,208 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:28:20,209 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-23 09:28:20,211 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-23 09:28:20,212 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-23 09:28:20,214 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-23 09:28:20,215 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-23 09:28:20,300 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:28:20,300 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:28:20,300 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:28:20,300 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:28:20,300 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-23 09:28:20,300 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-23 09:28:20,300 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-23 09:28:20,300 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-23 09:28:20,300 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-23 09:28:20,300 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-23 09:28:20,307 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-23 09:28:20,308 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-23 09:28:20,403 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:28:20,404 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:28:20,404 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-23 09:28:20,405 - AVRO_setup_logger - INFO - 🔍 Validating target columns against schema reference 'emp_details_avro_cls2' with available versions: []
2025-07-23 09:28:20,405 - AVRO_setup_logger - WARNING - ⚠️ No schema found for reference: emp_details_avro_cls2
2025-07-23 09:28:23,279 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:28:24,748 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-23 09:28:27,370 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bde25c-0206-0e5d-000c-7ee3000db062
2025-07-23 09:28:27,370 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bde25c-0206-0e5d-000c-7ee3000db062
2025-07-23 09:28:27,506 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bde25c-0206-0e5d-000c-7ee3000db062'
        )
    )
2025-07-23 09:28:28,423 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-23 09:28:28,423 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 12.08 seconds
2025-07-23 09:28:28,898 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:28:28,898 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:28:28,898 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-23 09:28:28,898 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-23 09:28:29,519 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-23 09:28:30,033 - AVRO_setup_logger - INFO - 🛑 Session 3517213143896086 closed and audit updated.
2025-07-23 09:30:18,259 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-23 09:30:18,259 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-23 09:30:18,259 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-23 09:30:18,259 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-23 09:30:18
2025-07-23 09:30:18,259 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-23 09:30:18,307 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-23 09:30:20,049 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-23 09:30:20,148 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143896090  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-23 09:30:20.950000-07:00 2999-01-01
2025-07-23 09:30:20,148 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-23 09:30:20,148 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-23 09:30:21,391 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-23 09:30:21,667 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:30:21,667 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:30:21,667 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-23 09:30:21,667 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-23 09:30:21,667 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-23 09:30:21,683 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-23 09:30:21,684 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-23 09:30:21,733 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:30:21,733 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:30:21,733 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:30:21,733 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:30:21,733 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-23 09:30:21,749 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-23 09:30:21,751 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-23 09:30:21,757 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-23 09:30:21,759 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-23 09:30:21,762 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-23 09:30:21,762 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-23 09:30:21,766 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-23 09:30:21,849 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:30:21,849 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:30:21,849 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-23 09:30:21,849 - AVRO_setup_logger - INFO - 🔍 Validating target columns against schema reference 'emp_details_avro_cls@v1.0' with available versions: ['v1.0']
2025-07-23 09:30:22,250 - AVRO_setup_logger - INFO - 🛑 Session 3517213143896090 closed and audit updated.
2025-07-23 09:30:23,076 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: 'tuple' object has no attribute 'fields'
2025-07-23 09:32:14,579 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-23 09:32:14,580 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-23 09:32:14,580 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-23 09:32:14,580 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-23 09:32:14
2025-07-23 09:32:14,580 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-23 09:32:14,618 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-23 09:32:17,154 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-23 09:32:17,283 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143875614  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-23 09:32:18.048000-07:00 2999-01-01
2025-07-23 09:32:17,340 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-23 09:32:17,345 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-23 09:32:18,744 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-23 09:32:18,981 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:32:18,997 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:32:18,997 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-23 09:32:18,997 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-23 09:32:18,997 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-23 09:32:18,997 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-23 09:32:19,014 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-23 09:32:19,099 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:32:19,100 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:32:19,100 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:32:19,101 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:32:19,101 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-23 09:32:19,103 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-23 09:32:19,105 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-23 09:32:19,108 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-23 09:32:19,111 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-23 09:32:19,113 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-23 09:32:19,118 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-23 09:32:19,121 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-23 09:32:19,202 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:32:19,202 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:32:19,202 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-23 09:32:19,202 - AVRO_setup_logger - INFO - 🔍 Validating target columns against schema reference 'emp_details_avro_cls@v1.0' with available versions: ['v1.0']
2025-07-23 09:32:19,714 - AVRO_setup_logger - INFO - 🛑 Session 3517213143875614 closed and audit updated.
2025-07-23 09:32:20,327 - AVRO_setup_logger - ERROR - ❌ Pipeline execution failed: 'tuple' object has no attribute 'fields'
2025-07-23 09:37:49,132 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-23 09:37:49,133 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-23 09:37:49,133 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-23 09:37:49,133 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-23 09:37:49
2025-07-23 09:37:49,133 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-23 09:37:49,182 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-23 09:37:51,111 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-23 09:37:51,340 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143847002  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-23 09:37:52.013000-07:00 2999-01-01
2025-07-23 09:37:51,340 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-23 09:37:51,340 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-23 09:37:52,713 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-23 09:37:52,821 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:37:52,821 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:37:52,821 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-23 09:37:52,821 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-23 09:37:52,821 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-23 09:37:52,821 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-23 09:37:52,821 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-23 09:37:52,873 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:37:52,873 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:37:52,873 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:37:52,873 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:37:52,873 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-23 09:37:52,875 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-23 09:37:52,875 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-23 09:37:52,875 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-23 09:37:52,875 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-23 09:37:52,875 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-23 09:37:52,875 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-23 09:37:52,882 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-23 09:37:52,962 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:37:52,962 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:37:52,963 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-23 09:37:52,963 - AVRO_setup_logger - INFO - 🔍 Validating target columns against schema reference 'emp_details_avro_cls@v1.0' with available versions: ['v1.0']
2025-07-23 09:37:52,963 - AVRO_setup_logger - INFO - ✅ Config target columns match schema reference 'emp_details_avro_cls@v1.0' exactly.
2025-07-23 09:37:52,963 - AVRO_setup_logger - INFO - ✅ Config target columns match schema reference 'emp_details_avro_cls@v1.0' exactly.
2025-07-23 09:37:55,387 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:37:56,497 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-23 09:37:57,630 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bde265-0206-0823-000c-7ee3000dd07a
2025-07-23 09:37:57,630 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bde265-0206-0823-000c-7ee3000dd07a
2025-07-23 09:37:57,672 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bde265-0206-0823-000c-7ee3000dd07a'
        )
    )
2025-07-23 09:37:58,294 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-23 09:37:58,294 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.16 seconds
2025-07-23 09:37:58,692 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:37:58,692 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:37:58,694 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-23 09:37:58,694 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-23 09:37:59,275 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-23 09:37:59,783 - AVRO_setup_logger - INFO - 🛑 Session 3517213143847002 closed and audit updated.
2025-07-23 09:38:47,002 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-23 09:38:47,003 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-23 09:38:47,004 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-23 09:38:47,004 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-23 09:38:47
2025-07-23 09:38:47,005 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-23 09:38:47,069 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-23 09:38:49,784 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-23 09:38:49,933 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143904262  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-23 09:38:50.689000-07:00 2999-01-01
2025-07-23 09:38:49,933 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-23 09:38:49,933 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-23 09:38:51,501 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-23 09:38:51,803 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:38:51,803 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:38:51,804 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-23 09:38:51,806 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-23 09:38:51,807 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-23 09:38:51,809 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-23 09:38:51,810 - AVRO_setup_logger - DEBUG - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-23 09:38:52,016 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:38:52,016 - AVRO_setup_logger - DEBUG - ✅ Column mappings ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:38:52,016 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:38:52,016 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:38:52,016 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: GENDER
2025-07-23 09:38:52,016 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-23 09:38:52,031 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: CC
2025-07-23 09:38:52,032 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COUNTRY
2025-07-23 09:38:52,033 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-23 09:38:52,034 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: SALARY
2025-07-23 09:38:52,034 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: TITLE
2025-07-23 09:38:52,035 - AVRO_setup_logger - DEBUG - 🗑️ Dropping unmapped column: COMMENTS
2025-07-23 09:38:52,826 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:38:52,826 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:38:52,828 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-23 09:38:52,828 - AVRO_setup_logger - INFO - 🔍 Validating target columns against schema reference 'emp_details_avro_cls@v1.0' with available versions: ['v1.0']
2025-07-23 09:38:52,828 - AVRO_setup_logger - INFO - ✅ Config target columns match schema reference 'emp_details_avro_cls@v1.0' exactly.
2025-07-23 09:38:56,330 - AVRO_setup_logger - DEBUG - ✅ Successfully wrote 1000 rows to temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ wit columns ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:38:58,095 - AVRO_setup_logger - DEBUG - 📤 Read 1000 rows from temporary stage: @demo_db.public.mystage/EMP_DETAILS_AVRO_CLS/ with columns ['"c1"', '"c2"', '"c3"', '"c4"', '"c5"']
2025-07-23 09:39:00,126 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bde266-0206-0823-000c-7ee3000dd096
2025-07-23 09:39:00,126 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bde266-0206-0823-000c-7ee3000dd096
2025-07-23 09:39:00,200 - AVRO_setup_logger - DEBUG - 🧪 Running reject collection query: SELECT * FROM TABLE(
        VALIDATE(
            DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS,
            JOB_ID => '01bde266-0206-0823-000c-7ee3000dd096'
        )
    )
2025-07-23 09:39:01,825 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-23 09:39:01,825 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 14.82 seconds
2025-07-23 09:39:02,501 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:39:02,502 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:39:02,502 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-23 09:39:02,503 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-23 09:39:03,715 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-23 09:39:04,392 - AVRO_setup_logger - INFO - 🛑 Session 3517213143904262 closed and audit updated.
2025-07-23 09:42:04,401 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-23 09:42:04,401 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-23 09:42:04
2025-07-23 09:42:04,401 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-23 09:42:04,455 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-23 09:42:06,306 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-23 09:42:06,494 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143908358  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-23 09:42:07.257000-07:00 2999-01-01
2025-07-23 09:42:06,494 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-23 09:42:07,744 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-23 09:42:07,900 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:42:07,900 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:42:08,004 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-23 09:42:08,098 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:42:08,098 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-23 09:42:08,098 - AVRO_setup_logger - INFO - ✅ All df columns match config target columns.
2025-07-23 09:42:08,098 - AVRO_setup_logger - INFO - 🔍 Validating target columns against schema reference 'emp_details_avro_cls@v1.0' with available versions: ['v1.0']
2025-07-23 09:42:08,098 - AVRO_setup_logger - INFO - ✅ Config target columns match schema reference 'emp_details_avro_cls@v1.0' exactly.
2025-07-23 09:42:12,530 - AVRO_setup_logger - INFO - ✅ COPY INTO DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS succeeded after 1 attempt(s). Query ID: 01bde26a-0206-0eed-000c-7ee3000d913a
2025-07-23 09:42:12,530 - AVRO_setup_logger - INFO - 🔍 Query ID: 01bde26a-0206-0eed-000c-7ee3000d913a
2025-07-23 09:42:13,365 - AVRO_setup_logger - INFO - ✅ Rejects written to table: EMPLOYEE_AVRO_REJECTS
2025-07-23 09:42:13,365 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 8.96 seconds
2025-07-23 09:42:13,685 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:42:13,687 - AVRO_setup_logger - INFO - ✅ 1000 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-23 09:42:13,687 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-23 09:42:13,687 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-23 09:42:14,198 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-23 09:42:14,864 - AVRO_setup_logger - INFO - 🛑 Session 3517213143908358 closed and audit updated.
