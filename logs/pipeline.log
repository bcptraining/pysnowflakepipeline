2025-07-17 13:32:26,046 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:32:26
2025-07-17 13:32:26,047 - AVRO_load_to_stg.py - INFO - 📁 Using config file: ./config/connection_details.json
2025-07-17 13:32:26,047 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: ❌ Config file not found at: ./config/connection_details.json
2025-07-17 13:38:13,295 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:38:13
2025-07-17 13:38:13,295 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:38:13,296 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: ❌ RSA key not found at: ./config/snowflake_private_key.p8
2025-07-17 13:42:53,980 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:42:53
2025-07-17 13:42:53,982 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:42:53,983 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: ❌ RSA key not found at: ./config/snowflake_private_key.p8
2025-07-17 13:48:00,962 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:48:00
2025-07-17 13:48:00,963 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:48:01,076 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 13:48:05,209 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 13:48:05,449 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 13:50:21,839 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:50:21
2025-07-17 13:50:21,840 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:50:21,896 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 13:50:24,639 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 13:50:24,888 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 13:55:51,238 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 13:55:51
2025-07-17 13:55:51,238 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 13:55:51,286 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 13:55:53,256 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 13:55:53,422 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 14:04:05,075 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:04:05
2025-07-17 14:04:05,075 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:04:05,114 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:04:07,269 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:04:07,416 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 14:12:38,831 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:12:38
2025-07-17 14:12:38,831 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:12:38,893 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:12:41,524 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:12:41,524 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:12:42,659 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143752710 closed and audit updated.
2025-07-17 14:12:42,856 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: ❌ Unsupported file type: ''. Expected 'avro'.
2025-07-17 14:15:41,745 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:15:41
2025-07-17 14:15:41,746 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:15:41,807 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:15:44,526 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:15:44,527 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:15:44,527 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:15:46,304 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:15:46,477 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:15:46,480 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:15:46,486 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:15:46,489 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:15:46,493 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:15:46,495 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:15:46,538 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:15:46,538 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:15:47,151 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143736330 closed and audit updated.
2025-07-17 14:15:47,414 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: validate_schema_matches_table() missing 1 required positional argument: 'log'
2025-07-17 14:18:46,636 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:18:46
2025-07-17 14:18:46,636 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:18:46,674 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:18:48,096 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:18:48,096 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:18:48,097 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:18:49,797 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:18:49,918 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:18:49,951 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:18:49,953 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:18:49,956 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:18:49,958 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:18:49,960 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:18:50,119 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:18:50,119 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:18:50,779 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143744530 closed and audit updated.
2025-07-17 14:18:51,033 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: 'list' object has no attribute 'log'
2025-07-17 14:29:54,228 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:29:54
2025-07-17 14:29:54,230 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:29:54,267 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:29:56,778 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:29:56,779 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:29:56,780 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:29:59,006 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:29:59,096 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:29:59,100 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:29:59,102 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:29:59,105 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:29:59,108 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:29:59,111 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:29:59,159 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:29:59,160 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:29:59,160 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:29:59,160 - AVRO_load_to_stg.py - WARNING - ⚠️ Missing expected columns: []
2025-07-17 14:29:59,160 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:30:00,765 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:30:00,870 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 14:30:00,870 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 14:30:00,871 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 14:30:00,872 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 14:30:00,873 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 14:30:01,020 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "registration_dttm"
2025-07-17 14:30:01,022 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "id"
2025-07-17 14:30:01,025 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "first_name"
2025-07-17 14:30:01,027 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "last_name"
2025-07-17 14:30:01,032 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "email"
2025-07-17 14:30:01,035 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "gender"
2025-07-17 14:30:01,037 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "ip_address"
2025-07-17 14:30:01,038 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "cc"
2025-07-17 14:30:01,040 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "country"
2025-07-17 14:30:01,042 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "birthdate"
2025-07-17 14:30:01,043 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "salary"
2025-07-17 14:30:01,046 - AVRO_load_to_stg.py - INFO - 🗑️ Dropped unmapped column: "title"
2025-07-17 14:30:01,536 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143756806 closed and audit updated.
2025-07-17 14:30:01,916 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1101): Cannot drop all columns
2025-07-17 14:51:27,432 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:51:27
2025-07-17 14:51:27,433 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:51:27,494 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:51:29,911 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:51:29,912 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:51:29,912 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:51:31,564 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:51:31,658 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:51:31,661 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:51:31,664 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:51:31,667 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:51:31,670 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:51:31,674 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:51:31,724 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:51:31,724 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:51:31,725 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:51:31,726 - AVRO_load_to_stg.py - WARNING - ⚠️ Missing expected columns: []
2025-07-17 14:51:31,726 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:51:33,416 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:51:33,463 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 14:51:33,464 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 14:51:33,464 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 14:51:33,465 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 14:51:33,465 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 14:51:33,466 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 14:51:33,883 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143744534 closed and audit updated.
2025-07-17 14:51:34,100 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 14:55:01,040 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 14:55:01
2025-07-17 14:55:01,041 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 14:55:01,082 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 14:55:03,043 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 14:55:03,043 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 14:55:03,044 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:55:04,335 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 14:55:04,441 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:55:04,442 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 14:55:04,443 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 14:55:04,445 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 14:55:04,445 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 14:55:04,446 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 14:55:04,490 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 14:55:04,491 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 14:55:04,492 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:55:04,493 - AVRO_load_to_stg.py - WARNING - ⚠️ Missing expected columns: []
2025-07-17 14:55:04,493 - AVRO_load_to_stg.py - WARNING - ⚠️ Unused columns from source: ['BIRTHDATE', 'CC', 'COMMENTS', 'COUNTRY', 'GENDER', 'IP_ADDRESS', 'SALARY', 'TITLE']
2025-07-17 14:55:06,222 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 14:55:06,267 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 14:55:06,269 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 14:55:06,269 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 14:55:06,270 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 14:55:06,270 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 14:55:06,271 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 14:55:07,106 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760902 closed and audit updated.
2025-07-17 14:55:07,322 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:21:33,684 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:21:33
2025-07-17 15:21:33,685 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:21:33,771 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:21:36,496 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:21:36,497 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:21:36,497 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:21:38,715 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:21:38,845 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:21:38,848 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:21:38,852 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:21:38,854 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:21:38,857 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:21:38,860 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:21:38,910 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:21:38,912 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:21:38,913 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:21:38,913 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:21:38,914 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:21:38,915 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:21:38,916 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:21:38,917 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:21:38,965 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:21:38,965 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:21:38,965 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:21:38,966 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:21:40,423 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:21:40,478 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:21:40,478 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:21:40,479 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:21:40,479 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:21:40,480 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:21:40,480 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:21:41,432 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143764998 closed and audit updated.
2025-07-17 15:21:41,686 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:30:37,082 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:30:37
2025-07-17 15:30:37,082 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:30:37,118 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:30:39,114 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:30:39,115 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:30:39,116 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:30:41,102 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:30:41,294 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:30:41,298 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:30:41,301 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:30:41,304 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:30:41,308 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:30:41,310 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:30:41,407 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:30:41,410 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:30:41,413 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:30:41,416 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:30:41,419 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:30:41,421 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:30:41,424 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:30:41,426 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:30:41,476 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:30:41,476 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:30:41,477 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:30:41,477 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:30:42,656 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:30:42,707 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:30:42,708 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:30:42,708 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:30:42,709 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:30:42,710 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:30:42,711 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:30:43,458 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143769094 closed and audit updated.
2025-07-17 15:30:43,680 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:32:48,988 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:32:48
2025-07-17 15:32:48,988 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:32:49,025 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:32:51,026 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:32:51,027 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:32:51,028 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:32:52,553 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:32:52,640 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:32:52,642 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:32:52,643 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:32:52,644 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:32:52,645 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:32:52,646 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:32:52,692 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:32:52,694 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:32:52,695 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:32:52,696 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:32:52,697 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:32:52,698 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:32:52,699 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:32:52,699 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:32:52,866 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:32:52,867 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:32:52,868 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:32:52,868 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:32:53,781 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:32:53,827 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:32:53,828 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:32:53,828 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:32:53,828 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:32:53,829 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:32:53,829 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:32:54,561 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143748618 closed and audit updated.
2025-07-17 15:32:54,737 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:40:51,498 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:40:51
2025-07-17 15:40:51,498 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:40:51,542 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:40:53,728 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:40:53,729 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:40:53,730 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:40:55,138 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:40:55,326 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:40:55,330 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:40:55,333 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:40:55,337 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:40:55,342 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:40:55,346 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:40:55,346 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:40:55,644 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:40:55,645 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:40:55,646 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:40:55,646 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:40:55,649 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:40:55,651 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:40:55,654 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:40:55,656 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:40:55,657 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:40:55,659 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:40:55,660 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:40:55,713 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:40:55,713 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:40:55,714 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:40:55,714 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:40:56,969 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:40:57,020 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:40:57,021 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:40:57,021 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:40:57,021 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:40:57,022 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:40:57,022 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:40:57,022 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 15:40:57,022 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:40:57,518 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760906 closed and audit updated.
2025-07-17 15:40:57,734 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:51:07,093 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:51:07
2025-07-17 15:51:07,094 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:51:07,133 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:51:09,418 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:51:09,419 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:51:09,419 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:51:11,076 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:51:11,189 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:51:11,191 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:51:11,192 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:51:11,193 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:51:11,194 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:51:11,195 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:51:11,195 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:51:11,238 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:51:11,238 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:51:11,239 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:51:11,239 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:51:11,240 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:51:11,241 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:51:11,242 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:51:11,243 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:51:11,244 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:51:11,246 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:51:11,247 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:51:11,430 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:51:11,431 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:51:11,431 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:51:11,431 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:51:12,987 - AVRO_load_to_stg.py - INFO - 📥 Loaded Avro file from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:51:13,031 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 15:51:13,032 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 15:51:13,032 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'FIRST_NAME' not found — skipped
2025-07-17 15:51:13,032 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'LAST_NAME' not found — skipped
2025-07-17 15:51:13,032 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 15:51:13,033 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:51:13,033 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 15:51:13,033 - AVRO_load_to_stg.py - ERROR - ❌ No mapped columns found in DataFrame — would drop all columns.
2025-07-17 15:51:13,878 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143773190 closed and audit updated.
2025-07-17 15:51:14,135 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: No mapped columns present in DataFrame.
2025-07-17 15:59:15,301 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 15:59:15
2025-07-17 15:59:15,302 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 15:59:15,339 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 15:59:17,496 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 15:59:17,497 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 15:59:17,498 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 15:59:19,005 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 15:59:19,133 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:59:19,134 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 15:59:19,135 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 15:59:19,136 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 15:59:19,138 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 15:59:19,139 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 15:59:19,139 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:59:19,255 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:59:19,257 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 15:59:19,257 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:59:19,258 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 15:59:19,261 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 15:59:19,264 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 15:59:19,267 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 15:59:19,271 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 15:59:19,274 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 15:59:19,275 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 15:59:19,278 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 15:59:19,349 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:59:19,350 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 15:59:19,350 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:59:19,351 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 15:59:19,788 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143773194 closed and audit updated.
2025-07-17 15:59:19,967 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: 'NoneType' object has no attribute 'warning'
2025-07-17 16:03:57,761 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:03:57
2025-07-17 16:03:57,761 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:03:57,801 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:03:59,655 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:03:59,655 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:03:59,656 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:04:00,921 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:04:01,007 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:04:01,008 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:04:01,009 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:04:01,010 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:04:01,011 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:04:01,012 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:04:01,013 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,248 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:04:01,248 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:04:01,248 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,249 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:04:01,250 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:04:01,250 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:04:01,251 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:04:01,252 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:04:01,253 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:04:01,254 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:04:01,254 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:04:01,299 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,300 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,300 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:04:01,301 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:04:01,301 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:04:01,302 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:04:01,304 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:04:01,307 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:04:01,307 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:04:01,394 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:04:01,395 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:04:01,395 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:04:01,397 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:04:01,398 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:04:04,214 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760910 closed and audit updated.
2025-07-17 16:04:04,414 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: 'str' object has no attribute '_to_attributes'
2025-07-17 16:31:33,646 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:31:33
2025-07-17 16:31:33,647 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:31:33,691 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:31:36,738 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:31:36,738 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:31:36,739 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:31:38,501 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:31:38,716 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:31:38,719 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:31:38,722 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:31:38,726 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:31:38,729 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:31:38,732 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:31:38,733 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,787 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:31:38,787 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:31:38,788 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,788 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:31:38,791 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:31:38,792 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:31:38,793 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:31:38,795 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:31:38,797 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:31:38,799 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:31:38,800 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:31:38,849 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,849 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,850 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:31:38,850 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:31:38,851 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:31:38,851 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:31:38,852 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:31:38,854 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:31:38,854 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:31:38,901 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:31:38,902 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:31:38,902 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:31:38,904 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:31:38,905 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:31:40,008 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760914 closed and audit updated.
2025-07-17 16:31:40,207 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: name 'Target_table' is not defined
2025-07-17 16:36:42,198 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:36:42
2025-07-17 16:36:42,198 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:36:42,242 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:36:44,038 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:36:44,039 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:36:44,039 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:36:45,352 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:36:45,590 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:36:45,591 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:36:45,592 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:36:45,593 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:36:45,594 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:36:45,596 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:36:45,596 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,639 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:36:45,640 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:36:45,640 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,640 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:36:45,642 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:36:45,643 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:36:45,644 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:36:45,645 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:36:45,646 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:36:45,647 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:36:45,648 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:36:45,796 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,798 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,798 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:36:45,799 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:36:45,799 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:36:45,800 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:36:45,803 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:36:45,805 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:36:45,805 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:36:45,860 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:36:45,860 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:36:45,861 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:36:45,863 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:36:45,865 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:36:49,730 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: 01bdc248-0306-0009-000c-7ee3000a228a
2025-07-17 16:36:50,619 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143777286 closed and audit updated.
2025-07-17 16:36:50,832 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: can only concatenate str (not "NoneType") to str
2025-07-17 16:49:08,885 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:49:08
2025-07-17 16:49:08,886 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:49:08,933 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:49:11,558 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:49:11,559 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:49:11,559 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:49:12,842 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:49:13,039 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:49:13,042 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:49:13,045 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:49:13,048 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:49:13,050 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:49:13,053 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:49:13,053 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,116 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:49:13,117 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:49:13,118 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,118 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:49:13,120 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:49:13,122 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:49:13,123 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:49:13,125 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:49:13,126 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:49:13,127 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:49:13,128 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:49:13,174 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,174 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,174 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:49:13,175 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:49:13,175 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:49:13,175 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:49:13,176 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:49:13,177 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:49:13,177 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:49:13,232 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:49:13,233 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:49:13,234 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:49:13,236 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:49:13,237 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:49:16,591 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 16:49:16,592 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 16:49:17,370 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143744538 closed and audit updated.
2025-07-17 16:49:17,595 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: can only concatenate str (not "NoneType") to str
2025-07-17 16:58:04,374 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 16:58:04
2025-07-17 16:58:04,374 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 16:58:04,412 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 16:58:06,449 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 16:58:06,450 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 16:58:06,450 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 16:58:07,618 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 16:58:07,831 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:58:07,834 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 16:58:07,837 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 16:58:07,842 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:58:07,846 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:58:07,849 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 16:58:07,850 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:07,907 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:58:07,909 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 16:58:07,909 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:07,910 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 16:58:07,913 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 16:58:07,916 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 16:58:07,918 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 16:58:07,921 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 16:58:07,923 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 16:58:07,925 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 16:58:07,928 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 16:58:08,093 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:08,094 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:08,094 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:58:08,095 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 16:58:08,096 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 16:58:08,097 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 16:58:08,099 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 16:58:08,102 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 16:58:08,103 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 16:58:08,154 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 16:58:08,156 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 16:58:08,156 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 16:58:08,159 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 16:58:08,162 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 16:58:10,843 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 16:58:10,843 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 16:58:11,794 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760918 closed and audit updated.
2025-07-17 16:58:12,010 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: name 'log' is not defined
2025-07-17 17:04:22,929 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:04:22
2025-07-17 17:04:22,929 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:04:22,970 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:04:25,241 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:04:25,242 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:04:25,242 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:04:26,670 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:04:26,758 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:04:26,759 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:04:26,761 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:04:26,763 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:04:26,765 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:04:26,767 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:04:26,770 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:04:26,770 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:26,946 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:04:26,947 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:04:26,947 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:26,948 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:04:26,951 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:04:26,954 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:04:26,958 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:04:26,961 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:04:26,964 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:04:26,966 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:04:26,969 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:04:27,024 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:27,025 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:27,025 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:04:27,026 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:04:27,027 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:04:27,028 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:04:27,030 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:04:27,033 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:04:27,033 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:04:27,194 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:04:27,195 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:04:27,196 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:04:27,198 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:04:27,200 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:04:31,672 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:04:31,673 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:04:32,333 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143748622 closed and audit updated.
2025-07-17 17:04:32,542 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: name 'log' is not defined
2025-07-17 17:07:18,044 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:07:18
2025-07-17 17:07:18,045 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:07:18,106 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:07:21,199 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:07:21,214 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:07:21,214 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:07:22,795 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:07:23,066 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:07:23,067 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:07:23,068 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:07:23,069 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:07:23,070 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:07:23,071 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:07:23,073 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:07:23,073 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,116 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:07:23,116 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:07:23,116 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,117 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:07:23,118 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:07:23,119 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:07:23,121 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:07:23,122 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:07:23,123 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:07:23,125 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:07:23,126 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:07:23,183 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,183 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,183 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:07:23,184 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:07:23,184 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:07:23,184 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:07:23,185 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:07:23,186 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:07:23,186 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:07:23,239 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:07:23,239 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:07:23,240 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:07:23,241 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:07:23,242 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:07:30,323 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:07:30,323 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:07:30,798 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143773198 closed and audit updated.
2025-07-17 17:07:31,077 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: collect_rejects() missing 1 required positional argument: 'log'
2025-07-17 17:11:14,989 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:11:14
2025-07-17 17:11:14,989 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:11:15,038 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:11:16,978 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:11:16,979 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:11:16,980 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:11:18,492 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:11:18,594 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:11:18,595 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:11:18,599 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:11:18,601 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:11:18,602 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:11:18,604 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:11:18,605 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:11:18,606 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,648 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:11:18,649 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:11:18,649 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,649 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:11:18,650 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:11:18,651 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:11:18,653 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:11:18,654 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:11:18,655 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:11:18,659 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:11:18,661 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:11:18,718 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,718 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,719 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:11:18,719 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:11:18,719 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:11:18,720 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:11:18,721 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:11:18,722 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:11:18,722 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:11:18,790 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:11:18,791 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:11:18,791 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:11:18,792 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:11:18,792 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:11:22,154 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:11:22,155 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:11:22,206 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:11:22,642 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143736334 closed and audit updated.
2025-07-17 17:11:22,855 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: Cannot infer schema from empty data
2025-07-17 17:20:01,131 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:20:01
2025-07-17 17:20:01,133 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:20:01,205 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:20:03,464 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:20:03,465 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:20:03,466 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:20:04,776 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:20:04,882 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:20:04,883 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:20:04,886 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:20:04,890 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:20:04,893 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:20:04,896 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:20:04,899 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:20:04,900 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:04,947 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:20:04,947 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:20:04,948 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:04,948 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:20:04,949 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:20:04,950 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:20:04,951 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:20:04,952 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:20:04,953 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:20:04,953 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:20:04,954 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:20:04,999 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:05,000 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:05,000 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:20:05,001 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:20:05,001 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:20:05,002 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:20:05,003 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:20:05,004 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:20:05,005 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:20:05,052 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:20:05,053 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:20:05,053 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:20:05,054 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:20:05,055 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:20:09,279 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:20:09,279 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:20:09,333 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:20:09,852 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143748626 closed and audit updated.
2025-07-17 17:20:10,095 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: The provided schema or inferred schema cannot be None or empty
2025-07-17 17:24:25,256 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:24:25
2025-07-17 17:24:25,256 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:24:25,294 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:24:27,185 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:24:27,186 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:24:27,186 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:24:28,515 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:24:28,761 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:24:28,761 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:24:28,763 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:24:28,764 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:24:28,764 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:24:28,765 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:24:28,766 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:24:28,766 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,812 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:24:28,816 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:24:28,819 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,819 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:24:28,821 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:24:28,822 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:24:28,824 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:24:28,863 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:24:28,865 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:24:28,865 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:24:28,866 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:24:28,929 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,929 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,929 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:24:28,929 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:24:28,930 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:24:28,930 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:24:28,930 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:24:28,931 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:24:28,931 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:24:28,982 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:24:28,983 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:24:28,983 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:24:28,984 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:24:28,985 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:24:32,642 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:24:32,643 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:24:32,689 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:24:33,174 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143744542 closed and audit updated.
2025-07-17 17:24:33,398 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: name 'StructField' is not defined
2025-07-17 17:25:49,860 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:25:49
2025-07-17 17:25:49,861 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:25:49,960 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:25:52,329 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:25:52,329 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:25:52,329 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:25:53,784 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:25:53,934 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:25:53,935 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:25:53,938 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:25:53,942 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:25:53,945 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:25:53,948 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:25:53,950 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:25:53,951 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:53,996 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:25:53,996 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:25:53,997 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:53,997 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:25:53,998 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:25:53,999 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:25:53,999 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:25:54,000 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:25:54,001 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:25:54,002 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:25:54,003 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:25:54,048 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:54,049 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:54,049 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:25:54,050 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:25:54,050 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:25:54,050 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:25:54,051 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:25:54,052 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:25:54,053 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:25:54,096 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:25:54,097 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:25:54,097 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:25:54,099 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:25:54,100 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:25:57,376 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:25:57,377 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:25:57,431 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:25:57,483 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 7.62 seconds
2025-07-17 17:25:57,704 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:25:57,704 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:25:57,704 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:25:57,705 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:25:58,634 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143777290 closed and audit updated.
2025-07-17 17:25:58,842 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:29:16,964 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:29:16
2025-07-17 17:29:16,964 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:29:17,002 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:29:18,633 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:29:18,634 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:29:18,635 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:29:19,765 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:29:19,859 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:29:19,859 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:29:19,861 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:29:19,863 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:29:19,865 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:29:19,867 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:29:19,869 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:29:19,870 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:19,924 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:29:19,925 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:29:19,926 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:19,926 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:29:19,927 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:29:19,929 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:29:19,930 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:29:19,931 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:29:19,933 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:29:19,934 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:29:19,935 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:29:19,977 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:19,977 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:19,977 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:29:19,978 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:29:19,978 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:29:19,978 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:29:19,979 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:29:19,980 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:29:19,980 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:29:20,023 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:29:20,025 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:29:20,026 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:29:20,027 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:29:20,028 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:29:23,553 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:29:23,554 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:29:23,612 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:29:23,651 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 6.69 seconds
2025-07-17 17:29:23,852 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:29:23,853 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:29:23,853 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:29:23,854 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:29:24,594 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143760922 closed and audit updated.
2025-07-17 17:29:24,782 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:31:57,894 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:31:57
2025-07-17 17:31:57,894 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:31:57,931 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:31:59,556 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:31:59,556 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:31:59,557 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:32:00,912 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:32:01,017 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:32:01,018 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:32:01,019 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:32:01,020 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:32:01,021 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:32:01,022 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:32:01,023 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:32:01,024 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,077 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:32:01,077 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:32:01,078 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,078 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:32:01,081 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:32:01,082 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:32:01,084 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:32:01,087 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:32:01,088 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:32:01,090 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:32:01,092 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:32:01,151 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,152 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,152 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:32:01,153 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:32:01,153 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:32:01,153 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:32:01,154 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:32:01,155 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:32:01,155 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:32:01,204 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:32:01,204 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:32:01,205 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:32:01,207 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:32:01,209 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:32:05,224 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:32:05,225 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:32:05,271 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:32:05,316 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 7.42 seconds
2025-07-17 17:32:05,989 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:32:05,989 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:32:05,990 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:32:05,991 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:32:06,860 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143777294 closed and audit updated.
2025-07-17 17:32:07,058 - AVRO_load_to_stg.py - ERROR - ❌ Pipeline execution failed: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:51:01,360 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:51:01
2025-07-17 17:51:01,361 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:51:01,413 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:51:03,983 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:51:03,984 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:51:03,985 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:05,784 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:51:05,887 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:05,888 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:05,890 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:51:05,891 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:51:05,893 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:05,894 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:05,895 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:51:05,895 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,106 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:06,106 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:06,106 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,106 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:51:06,107 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:51:06,108 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:51:06,109 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:51:06,110 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:51:06,111 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:51:06,111 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:51:06,112 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:51:06,155 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,156 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,156 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:06,156 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:06,157 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:51:06,157 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:51:06,158 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:06,159 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:06,159 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:51:06,207 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:06,207 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:51:06,207 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:51:06,208 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:51:06,209 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:51:09,870 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:51:09,870 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:51:09,912 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:51:09,955 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 8.59 seconds
2025-07-17 17:51:10,166 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:10,167 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:10,167 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:51:10,167 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:51:10,633 - AVRO_load_to_stg.py - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:51:10,679 - AVRO_load_to_stg.py - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-17 17:51:11,348 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143752714 closed and audit updated.
2025-07-17 17:51:13,529 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:51:13
2025-07-17 17:51:13,529 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:51:13,566 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:51:14,950 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:51:14,951 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:51:14,951 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:16,184 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:51:16,279 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:16,280 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:16,283 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:51:16,285 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:51:16,288 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:16,291 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:16,294 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:51:16,294 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,342 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:16,342 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:16,342 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,342 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:51:16,345 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:51:16,346 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:51:16,348 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:51:16,349 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:51:16,352 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:51:16,353 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:51:16,354 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:51:16,397 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,398 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,398 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:16,399 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:16,400 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:51:16,400 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:51:16,402 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:16,403 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:16,404 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:51:16,448 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:16,448 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:51:16,449 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:51:16,450 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:51:16,450 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:51:19,406 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:51:19,406 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:51:19,452 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:51:19,493 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 5.96 seconds
2025-07-17 17:51:19,694 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:19,694 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:19,695 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:51:19,696 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:51:20,127 - AVRO_load_to_stg.py - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:51:20,175 - AVRO_load_to_stg.py - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-17 17:51:20,574 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143752718 closed and audit updated.
2025-07-17 17:51:22,618 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-17 17:51:22
2025-07-17 17:51:22,619 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-17 17:51:22,659 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-17 17:51:23,840 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-17 17:51:23,841 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-17 17:51:23,841 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:25,195 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-17 17:51:25,319 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:25,319 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-17 17:51:25,320 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-17 17:51:25,321 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-17 17:51:25,323 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:25,325 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:25,327 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-17 17:51:25,327 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,374 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:25,375 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-17 17:51:25,375 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,376 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-17 17:51:25,378 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-17 17:51:25,379 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-17 17:51:25,380 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-17 17:51:25,381 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-17 17:51:25,382 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-17 17:51:25,383 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-17 17:51:25,384 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-17 17:51:25,429 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,429 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,430 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:25,430 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-17 17:51:25,430 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-17 17:51:25,430 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-17 17:51:25,432 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-17 17:51:25,433 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-17 17:51:25,433 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-17 17:51:25,475 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-17 17:51:25,476 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-17 17:51:25,476 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-17 17:51:25,477 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-17 17:51:25,478 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-17 17:51:29,343 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-17 17:51:29,344 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-17 17:51:29,392 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-17 17:51:29,438 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 6.82 seconds
2025-07-17 17:51:29,672 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:29,673 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-17 17:51:29,674 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-17 17:51:29,674 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-17 17:51:30,231 - AVRO_load_to_stg.py - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-17 17:51:30,283 - AVRO_load_to_stg.py - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-17 17:51:30,719 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143769098 closed and audit updated.
2025-07-18 08:21:08,996 - AVRO_load_to_stg.py - INFO - ✅ Pipeline started: 2025-07-18 08:21:08
2025-07-18 08:21:08,998 - AVRO_load_to_stg.py - INFO - 📁 Using config file: snow_pipeline_pkg/config/connection_details.json
2025-07-18 08:21:09,053 - AVRO_load_to_stg.py - INFO - 🔗 Creating Snowpark session...
2025-07-18 08:21:12,732 - AVRO_load_to_stg.py - INFO - 🧊 Session audit logged with:
2025-07-18 08:21:12,771 - AVRO_load_to_stg.py - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-18 08:21:12,772 - AVRO_load_to_stg.py - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 08:21:14,976 - AVRO_load_to_stg.py - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 08:21:15,077 - AVRO_load_to_stg.py - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 08:21:15,078 - AVRO_load_to_stg.py - INFO - 📦 Processing file: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 08:21:15,081 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 08:21:15,089 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 08:21:15,092 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 08:21:15,095 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 08:21:15,098 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 08:21:15,099 - AVRO_load_to_stg.py - DEBUG - 🎯 ---------------------Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,171 - AVRO_load_to_stg.py - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 08:21:15,171 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 08:21:15,172 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,173 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 08:21:15,176 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 08:21:15,179 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 08:21:15,181 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 08:21:15,184 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 08:21:15,186 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 08:21:15,188 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 08:21:15,190 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 08:21:15,250 - AVRO_load_to_stg.py - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,251 - AVRO_load_to_stg.py - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,251 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-18 08:21:15,252 - AVRO_load_to_stg.py - INFO - ✅ All schema columns matched.
2025-07-18 08:21:15,252 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 08:21:15,253 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 08:21:15,254 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 08:21:15,256 - AVRO_load_to_stg.py - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 08:21:15,256 - AVRO_load_to_stg.py - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 08:21:15,522 - AVRO_load_to_stg.py - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 08:21:15,522 - AVRO_load_to_stg.py - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 08:21:15,522 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 08:21:15,523 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 08:21:15,524 - AVRO_load_to_stg.py - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 08:21:20,048 - AVRO_load_to_stg.py - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 08:21:20,048 - AVRO_load_to_stg.py - INFO - 🔍 Query ID: None
2025-07-18 08:21:20,100 - AVRO_load_to_stg.py - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 08:21:20,158 - AVRO_load_to_stg.py - INFO - ⏱️ Pipeline completed in 11.16 seconds
2025-07-18 08:21:20,321 - AVRO_load_to_stg.py - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 08:21:20,322 - AVRO_load_to_stg.py - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 08:21:20,323 - AVRO_load_to_stg.py - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 08:21:20,324 - AVRO_load_to_stg.py - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 08:21:20,827 - AVRO_load_to_stg.py - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-18 08:21:20,877 - AVRO_load_to_stg.py - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 08:21:21,843 - AVRO_load_to_stg.py - INFO - 🛑 Session 3517213143748630 closed and audit updated.
2025-07-18 11:54:43,042 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 11:54:43,042 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 11:54:43,043 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 11:54:43
2025-07-18 11:54:43,043 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 11:54:43,099 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 11:54:46,792 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 11:54:46,793 - AVRO_setup_logger - INFO - 🧊 Session audit skipped due to pandas fetch issue.
2025-07-18 11:54:46,794 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 11:54:46,795 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 11:54:48,598 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 11:54:48,833 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,834 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,837 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 11:54:48,840 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 11:54:48,842 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 11:54:48,844 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 11:54:48,846 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 11:54:48,897 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,898 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,899 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 11:54:48,899 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 11:54:48,899 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 11:54:48,900 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 11:54:48,902 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 11:54:48,903 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 11:54:48,904 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 11:54:48,905 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 11:54:48,906 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 11:54:48,907 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 11:54:48,953 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 11:54:48,954 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 11:54:48,954 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 11:54:48,954 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 11:54:48,954 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 11:54:48,954 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 11:54:48,955 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 11:54:48,956 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 11:54:48,956 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 11:54:49,008 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 11:54:49,009 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 11:54:49,009 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 11:54:49,010 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 11:54:49,011 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 11:54:52,921 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 11:54:52,922 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 11:54:52,971 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 11:54:53,039 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 10.0 seconds
2025-07-18 11:54:53,273 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 11:54:53,274 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 11:54:53,275 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 11:54:53,276 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 11:54:53,741 - AVRO_setup_logger - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-18 11:54:53,789 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 11:54:54,235 - AVRO_setup_logger - INFO - 🛑 Session 3517213143781382 closed and audit updated.
2025-07-18 12:27:47,603 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 12:27:47,604 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 12:27:47,604 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 12:27:47
2025-07-18 12:27:47,604 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 12:27:47,651 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 12:27:50,809 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 12:27:50,892 - AVRO_setup_logger - WARNING - ⚠️ Could not convert session details to pandas DataFrame so session audit was skipped: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-18 12:27:50,893 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:27:50,894 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 12:27:52,474 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 12:27:52,585 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,586 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,589 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 12:27:52,594 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 12:27:52,597 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:27:52,600 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:27:52,604 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 12:27:52,655 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,657 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,657 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:27:52,657 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:27:52,658 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 12:27:52,659 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 12:27:52,661 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 12:27:52,663 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 12:27:52,664 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 12:27:52,665 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 12:27:52,667 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 12:27:52,668 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 12:27:52,802 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:27:52,802 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:27:52,802 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:27:52,802 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:27:52,802 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 12:27:52,803 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 12:27:52,803 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:27:52,804 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:27:52,804 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 12:27:52,852 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:27:52,853 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:27:52,854 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 12:27:52,857 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 12:27:52,859 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 12:27:56,217 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 12:27:56,217 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 12:27:56,263 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 12:27:56,309 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 8.7 seconds
2025-07-18 12:27:56,476 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:27:56,476 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:27:56,476 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 12:27:56,477 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 12:27:56,973 - AVRO_setup_logger - WARNING - ⚠️ Could not extract reject sample: (1406): Failed to fetch a pandas Dataframe. The error is: 255002: Optional dependency: 'pandas' is not installed, please see the following link for install instructions: https://docs.snowflake.com/en/user-guide/python-connector-pandas.html#installation
2025-07-18 12:27:57,014 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 12:27:58,216 - AVRO_setup_logger - INFO - 🛑 Session 3517213143785478 closed and audit updated.
2025-07-18 12:29:45,370 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 12:29:45,371 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 12:29:45,371 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 12:29:45
2025-07-18 12:29:45,371 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 12:29:45,417 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 12:29:48,001 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 12:29:48,143 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143789574  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 12:29:48.216000-07:00 2999-01-01
2025-07-18 12:29:48,143 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:29:48,143 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 12:29:49,690 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 12:29:49,794 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,795 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,796 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 12:29:49,797 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 12:29:49,798 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:29:49,799 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:29:49,800 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 12:29:49,842 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,843 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,843 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:29:49,843 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:29:49,844 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 12:29:49,845 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 12:29:49,846 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 12:29:49,847 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 12:29:49,848 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 12:29:49,849 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 12:29:49,850 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 12:29:49,852 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 12:29:49,893 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:29:49,894 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:29:49,894 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:29:49,894 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:29:49,895 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 12:29:49,895 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 12:29:49,896 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:29:49,897 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:29:49,897 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 12:29:49,946 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:29:49,946 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:29:49,947 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 12:29:49,948 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 12:29:49,950 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 12:29:54,444 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 12:29:54,445 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 12:29:54,492 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 12:29:54,528 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.16 seconds
2025-07-18 12:29:54,671 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:29:54,672 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:29:54,672 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 12:29:54,672 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 12:29:55,106 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 12:29:56,053 - AVRO_setup_logger - INFO - 🛑 Session 3517213143789574 closed and audit updated.
2025-07-18 12:42:37,956 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 12:42:37,956 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-18 12:42:37,956 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 12:42:37,957 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 12:42:37
2025-07-18 12:42:37,957 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 12:42:37,996 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 12:42:40,670 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 12:42:41,034 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143789578  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 12:42:41.165000-07:00 2999-01-01
2025-07-18 12:42:41,034 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:42:41,034 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 12:42:42,613 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 12:42:42,896 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,896 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,898 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 12:42:42,901 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 12:42:42,904 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:42:42,907 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:42:42,909 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 12:42:42,965 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,966 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,966 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 12:42:42,966 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:42:42,967 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 12:42:42,967 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 12:42:42,969 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 12:42:42,970 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 12:42:42,971 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 12:42:42,971 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 12:42:42,973 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 12:42:42,973 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 12:42:43,019 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:42:43,019 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:42:43,019 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:42:43,020 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 12:42:43,020 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 12:42:43,020 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 12:42:43,021 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 12:42:43,022 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 12:42:43,022 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 12:42:43,067 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 12:42:43,069 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 12:42:43,070 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 12:42:43,072 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 12:42:43,073 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 12:42:46,977 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 12:42:46,977 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 12:42:47,036 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 12:42:47,077 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.12 seconds
2025-07-18 12:42:47,288 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:42:47,289 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 12:42:47,289 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 12:42:47,289 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 12:42:47,818 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 12:42:48,398 - AVRO_setup_logger - INFO - 🛑 Session 3517213143789578 closed and audit updated.
2025-07-18 14:46:36,756 - AVRO_setup_logger - DEBUG - ✅ Log initialized with log_file: logs/pipeline.log
2025-07-18 14:46:36,757 - AVRO_setup_logger - INFO - ✅ All required dependencies are installed.
2025-07-18 14:46:36,758 - AVRO_setup_logger - DEBUG - ✅ copy_config loaded with required keys present: logs/pipeline.log
2025-07-18 14:46:36,758 - AVRO_setup_logger - INFO - ✅ Pipeline started: 2025-07-18 14:46:36
2025-07-18 14:46:36,759 - AVRO_setup_logger - INFO - 📁 Connection config file determined to be: snow_pipeline_pkg/config/connection_details.json
2025-07-18 14:46:36,814 - AVRO_setup_logger - INFO - 🔗 Creating Snowpark session...
2025-07-18 14:46:40,233 - AVRO_setup_logger - INFO - 🧊 Session audit logged with:
2025-07-18 14:46:40,378 - AVRO_setup_logger - INFO -          SESSION_ID USER_NAME   WAREHOUSE    ROLE                       CREATED_AT  CLOSED_AT
0  3517213143793670  SNOWPARK  COMPUTE_WH  PUBLIC 2025-07-18 14:46:40.489000-07:00 2999-01-01
2025-07-18 14:46:40,378 - AVRO_setup_logger - DEBUG - 🔄 Column mapping defined: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 14:46:40,379 - AVRO_setup_logger - INFO - 📥 Reading Avro data from: @my_s3_stage/Avro_folder/userdata1.avro
2025-07-18 14:46:42,379 - AVRO_setup_logger - INFO - 🔍 Avro file loaded with columns: ['"registration_dttm"', '"id"', '"first_name"', '"last_name"', '"email"', '"gender"', '"ip_address"', '"cc"', '"country"', '"birthdate"', '"salary"', '"title"', '"comments"']
2025-07-18 14:46:42,540 - AVRO_setup_logger - INFO - 🧼 Normalized columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,540 - AVRO_setup_logger - INFO - 🔍 Loaded Avro data from @my_s3_stage/Avro_folder/userdata1.avro with columns: ['REGISTRATION_DTTM', 'ID', 'FIRST_NAME', 'LAST_NAME', 'EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,543 - AVRO_setup_logger - INFO - 🔄 Renamed 'REGISTRATION_DTTM' → 'REGISTRATION'
2025-07-18 14:46:42,556 - AVRO_setup_logger - INFO - 🔄 Renamed 'ID' → 'USER_ID'
2025-07-18 14:46:42,557 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 14:46:42,559 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 14:46:42,560 - AVRO_setup_logger - INFO - 🔄 Renamed 'EMAIL' → 'USER_EMAIL'
2025-07-18 14:46:42,609 - AVRO_setup_logger - INFO - 🔄 Renamed columns based on mapping: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,609 - AVRO_setup_logger - DEBUG - 🧪 ---------------------DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,610 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL', 'GENDER', 'IP_ADDRESS', 'CC', 'COUNTRY', 'BIRTHDATE', 'SALARY', 'TITLE', 'COMMENTS']
2025-07-18 14:46:42,610 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 14:46:42,610 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: GENDER
2025-07-18 14:46:42,611 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: IP_ADDRESS
2025-07-18 14:46:42,612 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: CC
2025-07-18 14:46:42,612 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COUNTRY
2025-07-18 14:46:42,613 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: BIRTHDATE
2025-07-18 14:46:42,613 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: SALARY
2025-07-18 14:46:42,614 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: TITLE
2025-07-18 14:46:42,614 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: COMMENTS
2025-07-18 14:46:42,665 - AVRO_setup_logger - INFO - Conformed and renamed (mapped) source columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 14:46:42,666 - AVRO_setup_logger - INFO - Target columns: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 14:46:42,666 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 14:46:42,666 - AVRO_setup_logger - INFO - ✅ All schema columns matched.
2025-07-18 14:46:42,667 - AVRO_setup_logger - WARNING - ⚠️ Column 'REGISTRATION_DTTM' not found — skipped
2025-07-18 14:46:42,667 - AVRO_setup_logger - WARNING - ⚠️ Column 'ID' not found — skipped
2025-07-18 14:46:42,668 - AVRO_setup_logger - INFO - 🔄 Renamed 'FIRST_NAME' → 'FIRST_NAME'
2025-07-18 14:46:42,669 - AVRO_setup_logger - INFO - 🔄 Renamed 'LAST_NAME' → 'LAST_NAME'
2025-07-18 14:46:42,669 - AVRO_setup_logger - WARNING - ⚠️ Column 'EMAIL' not found — skipped
2025-07-18 14:46:42,854 - AVRO_setup_logger - DEBUG - 🧪 DataFrame columns before drop: ['REGISTRATION', 'USER_ID', 'FIRST_NAME', 'LAST_NAME', 'USER_EMAIL']
2025-07-18 14:46:42,855 - AVRO_setup_logger - DEBUG - ✅ Mapped columns: {'REGISTRATION_DTTM': 'REGISTRATION', 'ID': 'USER_ID', 'FIRST_NAME': 'FIRST_NAME', 'LAST_NAME': 'LAST_NAME', 'EMAIL': 'USER_EMAIL'}
2025-07-18 14:46:42,855 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: REGISTRATION
2025-07-18 14:46:42,856 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_ID
2025-07-18 14:46:42,857 - AVRO_setup_logger - INFO - 🗑️ Dropping unmapped column: USER_EMAIL
2025-07-18 14:46:46,608 - AVRO_setup_logger - WARNING - ⚠️ No COPY query ID found — downstream reject handling may fail.
2025-07-18 14:46:46,608 - AVRO_setup_logger - INFO - 🔍 Query ID: None
2025-07-18 14:46:46,663 - AVRO_setup_logger - WARNING - ⚠️ No Query ID provided. Skipping reject collection.
2025-07-18 14:46:46,716 - AVRO_setup_logger - INFO - ⏱️ Pipeline completed in 9.96 seconds
2025-07-18 14:46:46,877 - AVRO_setup_logger - INFO - 📂 1 files loaded to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 14:46:46,878 - AVRO_setup_logger - INFO - ✅ 0 rows added to DEMO_DB.PUBLIC.EMP_DETAILS_AVRO_CLS
2025-07-18 14:46:46,878 - AVRO_setup_logger - WARNING - 🚫 0 rows sent to DEMO_DB.PUBLIC.EMPLOYEE_AVRO_REJECTS
2025-07-18 14:46:46,879 - AVRO_setup_logger - INFO - ✅ Pipeline execution completed successfully.
2025-07-18 14:46:47,310 - AVRO_setup_logger - INFO - 📊 Summary written to: dashboard\pipeline_summary.json
2025-07-18 14:46:47,912 - AVRO_setup_logger - INFO - 🛑 Session 3517213143793670 closed and audit updated.
